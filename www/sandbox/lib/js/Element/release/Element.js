(function(window){Util=window.Util||function(){};Util.hexToRGB=function(p_hex){this.cache=this.cache||[];if(this.cache[p_hex]){return this.cache[p_hex]}var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(p_hex);var _r=result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null;this.cache[p_hex]=_r;return _r};Util.RGBtoHSV=function(r,g,b){r=r/255;g=g/255;b=b/255;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var h,s,v=max;var d=max-min;s=max===0?0:d/max;if(max===min){h=0}else{switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;default:break}h/=6}return[h,s,v]};Util.HSVtoRGB=function(h,s,v){var r,g,b;var i=Math.floor(h*6);var f=h*6-i;var p=v*(1-s);var q=v*(1-f*s);var t=v*(1-(1-f)*s);switch(i%6){case 0:r=v;g=t;b=p;break;case 1:r=q;g=v;b=p;break;case 2:r=p;g=v;b=t;break;case 3:r=p;g=q;b=v;break;case 4:r=t;g=p;b=v;break;case 5:r=v;g=p;b=q;break;default:break}return[r*255,g*255,b*255]};Util.mixColors=function(t,rgb1,rgb2){var r=Util.linearInterpolate(t,rgb1[0],rgb2[0]);var g=Util.linearInterpolate(t,rgb1[1],rgb2[1]);var b=Util.linearInterpolate(t,rgb1[2],rgb2[2]);var a=Util.linearInterpolate(t,rgb1[3],rgb2[3]);return[r,g,b,a]};Util.linearInterpolate=function(t,a,b){return a+t*(b-a)};Util.createContext=function(p_id){var canvas=document.createElement("canvas");canvas.setAttribute("id","element-canvas_"+p_id);$$_canvas.canvas().appendChild(canvas);canvas.style.display="none";canvas.width=$$_canvas._canvas.width;canvas.height=$$_canvas._canvas.height;return{canvas:canvas,context:canvas.getContext("2d")}};Util.removeElement=function(p_id){var _el=document.getElementById(p_id);if(_el){_el.parentNode.removeChild(_el)}return true};Util.checkPIXEL=function(p_object,p_x,p_y){var _context=p_object.mouseDraw();var imageData=_context.getImageData(p_x,p_y,1,1);var index=(p_x+p_y*imageData.width)*4;if(imageData.data[3]>0){return true}return false};Util.getPixel=function(pixels,x,y,width,height){var pix=(y*width+x)*4;if(x<0||x>=width||y<0||y>=height){return[pixels[((Util.clampPixel(y,0,height-1)*width)+Util.clampPixel(x,0,width-1))*4],pixels[((Util.clampPixel(y,0,height-1)*width)+Util.clampPixel(x,0,width-1))*4+1],pixels[((Util.clampPixel(y,0,height-1)*width)+Util.clampPixel(x,0,width-1))*4+2],pixels[((Util.clampPixel(y,0,height-1)*width)+Util.clampPixel(x,0,width-1))*4+3]]}return[pixels[pix],pixels[pix+1],pixels[pix+2],pixels[pix+3]]};Util.clampPixel=function(x,a,b){return(x<a)?a:(x>b)?b:x};Util.bilinearInterpolate=function(x,y,nw,ne,sw,se){var m0,m1;var r0=nw[0];var g0=nw[1];var b0=nw[2];var a0=nw[3];var r1=ne[0];var g1=ne[1];var b1=ne[2];var a1=ne[3];var r2=sw[0];var g2=sw[1];var b2=sw[2];var a2=sw[3];var r3=se[0];var g3=se[1];var b3=se[2];var a3=se[3];var cx=1-x;var cy=1-y;m0=cx*a0+x*a1;m1=cx*a2+x*a3;var a=cy*m0+y*m1;m0=cx*r0+x*r1;m1=cx*r2+x*r3;var r=cy*m0+y*m1;m0=cx*g0+x*g1;m1=cx*g2+x*g3;var g=cy*m0+y*m1;m0=cx*b0+x*b1;m1=cx*b2+x*b3;var b=cy*m0+y*m1;return[r,g,b,a]};Util.triangle=function(x){var r=Util.mod(x,1);return 2*(r<0.5?r:1-r)};Util.mod=function(a,b){var n=parseInt(a/b,10);a-=n*b;if(a<0){return a+b}return a};Util.getIndex=function(p_child){var _i;for(var i=0;i<$$_CHILDREN.length;i++){if(p_child.id()==$$_CHILDREN[i].id()){_i=i}}return _i};function loadXMLDoc(){}Util.getJSON=function(p_path,p_callback,p_scope){var xmlhttp,scope;scope=p_scope||this;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){try{var json=JSON.parse(xmlhttp.responseText)}catch(e){var json=eval("("+xmlhttp.responseText+")")}p_callback.call(p_scope,json)}};xmlhttp.open("GET",p_path,true);xmlhttp.send()};window.Util=Util}(window));(function(b){Basic=function(){};var a=Basic.prototype;a.constructor=Basic;a.extend=function(d,e){for(var c in e){d[c]=e[c]}return d};b.Basic=Basic}(window));(function(b){Animate=function(c){this._tween=[]};var a=Animate.prototype;a.easing=function(c){if(c){this._easing=c;return this}else{return this._easing}};a.time=function(c){if(c){this._time=c;return this}else{return this._time}};a.easing=function(c){if(c){this._easing=c;return this}else{return this._easing||"Linear.EaseNone"}};a.animate=function(d,e,c){this._tween.push({props:e,time:d,easing:c||this.easing()});return this};a.start=function(c){if(this.ready()===false){var e=this,d=c;setTimeout(function(){e.start(d)},1000);return this}this._callback=c||"";this._tweenie.to(this,this._tween[0].props,(this._tween[0].time*1000),this._tween[0].easing,null,this._nextTween);return this};a.stop=function(){return this};a.pause=function(){return this};a._nextTween=function(){if(this._tween.length>1){this._tween.shift();this._tweenie.to(this,this._tween[0].props,(this._tween[0].time*1000),this._tween[0].easing,null,this._nextTween)}else{this._tween.shift();if(this._callback!==""){this._callback.call(this)}}};b.Animate=Animate}(window));(function(b){EventTarget=function(){this._listeners={}};var a=EventTarget.prototype=new Basic();a.constructor=EventTarget;a.bind=function(d,e,c){if(typeof this._listeners[d]=="undefined"){this._listeners[d]=[]}this._listeners[d].push({fn:e,scope:c})};a.unbind=function(f,g){if(this._listeners[f] instanceof Array){var e=this._listeners[f];for(var d=0,c=e.length;d<c;d++){if(e[d]===g){e.splice(d,1);break}}}};a.fire=function(f,g){if(typeof f=="string"){f={type:f}}if(!f.target){f.target=this}if(!f.type){throw new Error("Event object missing 'type' property.")}if(g){f.params=g}if(this._listeners[f.type] instanceof Array){var e=this._listeners[f.type];for(var d=0,c=e.length;d<c;d++){e[d].fn.call(e[d].scope||this,f)}}};b.EventTarget=EventTarget}(window));(function(window){Filter=function(){EventTarget.call(this)};var _pt=Filter.prototype;_pt.constructor=Filter;Filter.get=function(p_src,p_filter,p_ref){var _img;_img=p_src.context.getImageData(0,0,p_src.canvas.width,p_src.canvas.height);_img=Filter.filterImage(p_filter.effect,_img,p_filter.args[0],p_ref);p_src.context.putImageData(_img,0,0);return p_src.canvas};Filter.filterImage=function(p_filter,p_image,var_args,p_ref){var args=[p_image];for(var i=2;i<arguments.length;i++){args.push(arguments[i])}args.push[p_ref];return eval("Filter."+p_filter+".apply(p_ref, args)")};Filter.grayscale=function(p_pixels){var d=p_pixels.data;for(var i=0;i<d.length;i+=4){var r=d[i];var g=d[i+1];var b=d[i+2];var v=0.2126*r+0.7152*g+0.0722*b;d[i]=d[i+1]=d[i+2]=v}return p_pixels};Filter.brightness=function(p_pixels,p_adjustment){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var amount=p_adjustment||-1;for(var y=0;y<height;y++){for(var x=0;x<width;x++){var pixel=(y*width+x)*4;var hsv=Util.RGBtoHSV(inputData[pixel],inputData[pixel+1],inputData[pixel+2]);hsv[2]+=amount;if(hsv[2]<0){hsv[2]=0}else{if(hsv[2]>1){hsv[2]=1}}var rgb=Util.HSVtoRGB(hsv[0],hsv[1],hsv[2]);for(var i=0;i<3;i++){inputData[pixel+i]=rgb[i]}}}return p_pixels};Filter.threshold=function(p_pixels,p_threshold){var d=p_pixels.data;for(var i=0;i<d.length;i+=4){var r=d[i];var g=d[i+1];var b=d[i+2];var v=(0.2126*r+0.7152*g+0.0722*b>=p_threshold)?255:0;d[i]=d[i+1]=d[i+2]=v}return p_pixels};Filter.multiply=function(p_pixels,p_color){var d=p_pixels.data,_color=Util.hexToRGB(p_color);for(var i=0,n=d.length;i<n;i+=4){d[i]=Filter.multiplyPixels(_color.r,d[i]);d[i+1]=Filter.multiplyPixels(_color.g,d[i+1]);d[i+2]=Filter.multiplyPixels(_color.b,d[i+2])}return p_pixels};Filter.sharpen=function(p_pixels){return Filter.convolute(p_pixels,[0,-1,0,-1,5,-1,0,-1,0])};Filter.emboss=function(p_pixels){return Filter.convolute(p_pixels,[-2,-1,0,-1,1,1,0,1,2])};Filter.woodblock=function(p_pixels){var _temp=Filter.sobel.call(this,p_pixels);_temp=Filter.multiply.call(this,_temp,"#FF0000");_temp=Filter.threshold.call(this,_temp,5);return _temp};Filter.sobel=function(p_pixels){var px=p_pixels;var vertical=Filter.convoluteFloat32(px,[-1,-2,-1,0,0,0,1,2,1]);var horizontal=Filter.convoluteFloat32(px,[-1,0,1,-2,0,2,-1,0,1]);var id=Filter.createImageData(vertical.width,vertical.height);for(var i=0;i<id.data.length;i+=4){var v=Math.abs(vertical.data[i]);id.data[i]=v;var h=Math.abs(horizontal.data[i]);id.data[i+1]=h;id.data[i+2]=(v+h)/4;id.data[i+3]=255}return id};Filter.blur=function(p_pixels,p_amount){var width=p_pixels.width;var width4=width<<2;var height=p_pixels.height;var inputData=p_pixels.data;var q;var amount=p_amount;if(amount<0){amount=0}if(amount>=2.5){q=0.98711*amount-0.9633}else{if(amount>=0.5){q=3.97156-4.14554*Math.sqrt(1-0.26891*amount)}else{q=2*amount*(3.97156-4.14554*Math.sqrt(1-0.26891*0.5))}}var qq=q*q;var qqq=qq*q;var b0=1.57825+(2.44413*q)+(1.4281*qq)+(0.422205*qqq);var b1=((2.44413*q)+(2.85619*qq)+(1.26661*qqq))/b0;var b2=(-((1.4281*qq)+(1.26661*qqq)))/b0;var b3=(0.422205*qqq)/b0;var bigB=1-(b1+b2+b3);var c=0;var index;var indexLast;var pixel;var ppixel;var pppixel;var ppppixel;for(c=0;c<3;c++){for(var y=0;y<height;y++){index=y*width4+c;indexLast=y*width4+((width-1)<<2)+c;pixel=inputData[index];ppixel=pixel;pppixel=ppixel;ppppixel=pppixel;for(;index<=indexLast;index+=4){pixel=bigB*inputData[index]+b1*ppixel+b2*pppixel+b3*ppppixel;inputData[index]=pixel;ppppixel=pppixel;pppixel=ppixel;ppixel=pixel}index=y*width4+((width-1)<<2)+c;indexLast=y*width4+c;pixel=inputData[index];ppixel=pixel;pppixel=ppixel;ppppixel=pppixel;for(;index>=indexLast;index-=4){pixel=bigB*inputData[index]+b1*ppixel+b2*pppixel+b3*ppppixel;inputData[index]=pixel;ppppixel=pppixel;pppixel=ppixel;ppixel=pixel}}}for(c=0;c<3;c++){for(var x=0;x<width;x++){index=(x<<2)+c;indexLast=(height-1)*width4+(x<<2)+c;pixel=inputData[index];ppixel=pixel;pppixel=ppixel;ppppixel=pppixel;for(;index<=indexLast;index+=width4){pixel=bigB*inputData[index]+b1*ppixel+b2*pppixel+b3*ppppixel;inputData[index]=pixel;ppppixel=pppixel;pppixel=ppixel;ppixel=pixel}index=(height-1)*width4+(x<<2)+c;indexLast=(x<<2)+c;pixel=inputData[index];ppixel=pixel;pppixel=ppixel;ppppixel=pppixel;for(;index>=indexLast;index-=width4){pixel=bigB*inputData[index]+b1*ppixel+b2*pppixel+b3*ppppixel;inputData[index]=pixel;ppppixel=pppixel;pppixel=ppixel;ppixel=pixel}}}return p_pixels};Filter.median=function(p_pixels){var id=Filter.createImageData(p_pixels.width,p_pixels.height);for(var x=0;x<p_pixels.width;x++){for(var y=0;y<p_pixels.height;y++){var P=new Array();var count=0;for(var u=0;u<3;u++){for(var v=0;v<3;v++){var windowIndex=((x+u)+(y+v)*p_pixels.width)*4;var r=p_pixels.data[windowIndex+0];var g=p_pixels.data[windowIndex+1];var b=p_pixels.data[windowIndex+2];var a=p_pixels.data[windowIndex+3];P[count]=parseInt(parseFloat("0.33")*(parseFloat(r)+parseFloat(g)+parseFloat(b)));count++}}P.sort();var imageIndex=(x+y*p_pixels.width)*4;id.data[imageIndex+0]=parseInt(P[4]);id.data[imageIndex+1]=parseInt(P[4]);id.data[imageIndex+2]=parseInt(P[4]);id.data[imageIndex+3]=p_pixels.data[imageIndex+3]}}return id};Filter.invert=function(p_pixels){var newImageData=Filter.createImageData(p_pixels.width,p_pixels.height);var i=0;while(i<p_pixels.data.length){newImageData.data[i]=255-p_pixels.data[i++];newImageData.data[i]=255-p_pixels.data[i++];newImageData.data[i]=255-p_pixels.data[i++];newImageData.data[i]=p_pixels.data[i++]}return newImageData};Filter.circleSmear=function(p_pixels,p_values){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var outputData=[];for(var j=0;j<inputData.length;j++){outputData[j]=inputData[j]}var vals=p_values||{size:5,density:0.5,mix:0.5};var size=vals.size;if(size<1){size=1}size=parseInt(size,10);var density=vals.density;var mix=vals.mix;var radius=size+1;var radius2=radius*radius;var numShapes=parseInt(2*density/30*width*height/2,10);for(var i=0;i<numShapes;i++){var sx=(Math.random()*Math.pow(2,32)&2147483647)%width;var sy=(Math.random()*Math.pow(2,32)&2147483647)%height;var rgb2=[inputData[(sy*width+sx)*4],inputData[(sy*width+sx)*4+1],inputData[(sy*width+sx)*4+2],inputData[(sy*width+sx)*4+3]];for(var x=sx-radius;x<sx+radius+1;x++){for(var y=sy-radius;y<sy+radius+1;y++){var f=(x-sx)*(x-sx)+(y-sy)*(y-sy);if(x>=0&&x<width&&y>=0&&y<height&&f<=radius2){var rgb1=[outputData[(y*width+x)*4],outputData[(y*width+x)*4+1],outputData[(y*width+x)*4+2],outputData[(y*width+x)*4+3]];var mixedRGB=Util.mixColors(mix,rgb1,rgb2);for(var k=0;k<3;k++){outputData[(y*width+x)*4+k]=mixedRGB[k]}}}}}for(var l=0;l<outputData.length;l++){inputData[l]=outputData[l]}return p_pixels};Filter.diffuse=function(p_pixels,p_value){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var scale=p_value;var out=[];var outputData=[];var sinTable=[];var cosTable=[];for(var i=0;i<256;i++){var angle=Math.PI*2*i/256;sinTable[i]=scale*Math.sin(angle);cosTable[i]=scale*Math.cos(angle)}transInverse=function(x,y,out){var angle=parseInt(Math.random()*255,10);var distance=Math.random();out[0]=x+distance*sinTable[angle];out[1]=y+distance*cosTable[angle]};Filter.transformFilter(inputData,transInverse,width,height);return p_pixels};Filter.contrast=function(p_pixels,p_value){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var amount=p_value||2;if(amount<0){amount=0}var table=[];for(var i=0;i<256;i++){table[i]=parseInt(255*(((i/255)-0.5)*amount+0.5),10)}Filter.tableFilter(inputData,table,width,height);return p_pixels};Filter.sepia=function(p_pixels){var data=p_pixels.data;for(var i=0;i<data.length;i+=4){var r=data[i],g=data[i+1],b=data[i+2];data[i]=(r*0.393)+(g*0.769)+(b*0.189);data[i+1]=(r*0.349)+(g*0.686)+(b*0.168);data[i+2]=(r*0.272)+(g*0.534)+(b*0.131)}return p_pixels};Filter.dither=function(p_pixels,p_value){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var outputData=[];var i,j;for(j=0;j<inputData.length;j++){outputData[j]=0}if(p_value===undefined){p_value={levels:3,color:true}}var levels=p_value.levels;var color=p_value.color;if(levels<=1){levels=1}var matrix=[0,0,0,0,0,7,3,5,1];var sum=7+3+5+1;var index=0;var map=[];for(i=0;i<levels;i++){map[i]=parseInt(255*i/(levels-1),10)}var div=[];for(i=0;i<256;i++){div[i]=parseInt(levels*i/256,10)}for(var y=0;y<height;y++){var reverse=((y&1)==1);var direction;if(reverse){index=(y*width+width-1)*4;direction=-1}else{index=y*width*4;direction=1}for(var x=0;x<width;x++){var r1=inputData[index];var g1=inputData[index+1];var b1=inputData[index+2];if(!color){r1=g1=b1=parseInt((r1+g1+b1)/3,10)}var r2=map[div[r1]];var g2=map[div[g1]];var b2=map[div[b1]];outputData[index]=r2;outputData[index+1]=g2;outputData[index+2]=b2;outputData[index+3]=inputData[index+3];var er=r1-r2;var eg=g1-g2;var eb=b1-b2;for(i=-1;i<=1;i++){var iy=i+y;if(0<=iy&&iy<height){for(j=-1;j<=1;j++){var jx=j+x;if(0<=jx&&jx<width){var w;if(reverse){w=matrix[(i+1)*3-j+1]}else{w=matrix[(i+1)*3+j+1]}if(w!==0){var k=(reverse)?index-j*4:index+j*4;r1=inputData[k];g1=inputData[k+1];b1=inputData[k+2];var factor=w/sum;r1+=er*factor;g1+=eg*factor;b1+=eb*factor;inputData[k]=r1;inputData[k+1]=g1;inputData[k+2]=b1}}}}}index+=direction*4}}for(j=0;j<outputData.length;j++){inputData[j]=outputData[j]}return p_pixels};Filter.edge=function(p_pixels){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var outputData=[];var matrixH=[-1,-2,-1,0,0,0,1,2,1];var matrixV=[-1,0,1,-2,0,2,-1,0,1];for(var y=0;y<height;y++){for(var x=0;x<width;x++){var pixel=(y*width+x)*4;var rh=0;gh=0;bh=0;var rv=0;gv=0;bv=0;for(var row=-1;row<=1;row++){var iy=y+row;var ioffset;if(iy>=0&&iy<height){ioffset=iy*width*4}else{ioffset=y*width*4}var moffset=3*(row+1)+1;for(var col=-1;col<=1;col++){var ix=x+col;if(!(ix>=0&&ix<width)){ix=x}ix*=4;var r=inputData[ioffset+ix];var g=inputData[ioffset+ix+1];var b=inputData[ioffset+ix+2];var h=matrixH[moffset+col];var v=matrixV[moffset+col];rh+=parseInt(h*r,10);bh+=parseInt(h*g,10);gh+=parseInt(h*b,10);rv+=parseInt(v*r,10);gv+=parseInt(v*g,10);bv+=parseInt(v*b,10)}}r=parseInt(Math.sqrt(rh*rh+rv*rv)/1.8,10);g=parseInt(Math.sqrt(gh*gh+gv*gv)/1.8,10);b=parseInt(Math.sqrt(bh*bh+bv*bv)/1.8,10);outputData[pixel]=r;outputData[pixel+1]=g;outputData[pixel+2]=b;outputData[pixel+3]=inputData[pixel+3]}}for(var k=0;k<outputData.length;k++){inputData[k]=outputData[k]}return p_pixels};Filter.kaleidoscope=function(p_pixels,p_values){var width=p_pixels.width,height=p_pixels.height;var inputData=p_pixels.data;var defaultValues={angle:0,rotation:0,sides:3,centerX:0.5,centerY:0.5};var valueRanges={angle:{min:0,max:360},rotation:{min:0,max:360},sides:{min:1,max:30},centerX:{min:0,max:1},centerY:{min:0,max:1}};if(p_values===undefined){p_values=defaultValues}var angle=(p_values.angle===undefined)?defaultValues.angle:p_values.angle;var rotation=(p_values.rotation===undefined)?defaultValues.rotation:p_values.rotation;var sides=(p_values.sides===undefined)?defaultValues.sides:p_values.sides;var centerX=(p_values.centerX===undefined)?defaultValues.centerX:p_values.centerX;var centerY=(p_values.centerY===undefined)?defaultValues.centerY:p_values.centerY;var iCenterX=width*centerX;var iCenterY=height*centerY;angle=angle/180*Math.PI;rotation=rotation/180*Math.PI;var transInverse=function(x,y,out){var dx=x-iCenterX;var dy=y-iCenterY;var r=Math.sqrt(dx*dx+dy*dy);var theta=Math.atan2(dy,dx)-angle-rotation;theta=Util.triangle(theta/Math.PI*sides*0.5);theta+=angle;out[0]=iCenterX+r*Math.cos(theta);out[1]=iCenterY+r*Math.sin(theta)};Filter.transformFilter(inputData,transInverse,width,height);return p_pixels};Filter.transformFilter=function(inputData,transformInverse,width,height){var out=[];var outputData=[];for(var j=0;j<inputData.length;j++){outputData[j]=inputData[j]}for(var y=0;y<height;y++){for(var x=0;x<width;x++){var pixel=(y*width+x)*4;transformInverse.apply(this,[x,y,out]);var srcX=Math.floor(out[0]);var srcY=Math.floor(out[1]);var xWeight=out[0]-srcX;var yWeight=out[1]-srcY;var nw,ne,sw,se;if(srcX>=0&&srcX<width-1&&srcY>=0&&srcY<height-1){var i=(width*srcY+srcX)*4;nw=[inputData[i],inputData[i+1],inputData[i+2],inputData[i+3]];ne=[inputData[i+4],inputData[i+5],inputData[i+6],inputData[i+7]];sw=[inputData[i+width*4],inputData[i+width*4+1],inputData[i+width*4+2],inputData[i+width*4+3]];se=[inputData[i+(width+1)*4],inputData[i+(width+1)*4+1],inputData[i+(width+1)*4+2],inputData[i+(width+1)*4+3]]}else{nw=Util.getPixel(inputData,srcX,srcY,width,height);ne=Util.getPixel(inputData,srcX+1,srcY,width,height);sw=Util.getPixel(inputData,srcX,srcY+1,width,height);se=Util.getPixel(inputData,srcX+1,srcY+1,width,height)}var rgba=Util.bilinearInterpolate(xWeight,yWeight,nw,ne,sw,se);outputData[pixel]=rgba[0];outputData[pixel+1]=rgba[1];outputData[pixel+2]=rgba[2];outputData[pixel+3]=rgba[3]}}for(var k=0;k<outputData.length;k++){inputData[k]=outputData[k]}};Filter.convolute=function(p_pixels,p_weights,p_opaque){var side=Math.round(Math.sqrt(p_weights.length));var halfSide=Math.floor(side/2);var src=p_pixels.data;var sw=p_pixels.width;var sh=p_pixels.height;var w=sw;var h=sh;var output=Filter.createImageData(w,h);var dst=output.data;var alphaFac=p_opaque?1:0;for(var y=0;y<h;y++){for(var x=0;x<w;x++){var sy=y;var sx=x;var dstOff=(y*w+x)*4;var r=0,g=0,b=0,a=0;for(var cy=0;cy<side;cy++){for(var cx=0;cx<side;cx++){var scy=Math.min(sh-1,Math.max(0,sy+cy-halfSide));var scx=Math.min(sw-1,Math.max(0,sx+cx-halfSide));var srcOff=(scy*sw+scx)*4;var wt=p_weights[cy*side+cx];r+=src[srcOff]*wt;g+=src[srcOff+1]*wt;b+=src[srcOff+2]*wt;a+=src[srcOff+3]*wt}}dst[dstOff]=r;dst[dstOff+1]=g;dst[dstOff+2]=b;dst[dstOff+3]=a+alphaFac*(255-a)}}return output};Filter.convoluteFloat32=function(p_pixels,p_weights,p_opaque){if(!window.Float32Array){Float32Array=Array}var side=Math.round(Math.sqrt(p_weights.length));var halfSide=Math.floor(side/2);var src=p_pixels.data;var sw=p_pixels.width;var sh=p_pixels.height;var w=sw;var h=sh;var output={width:w,height:h,data:new Float32Array(w*h*4)};var dst=output.data;var alphaFac=p_opaque?1:0;for(var y=0;y<h;y++){for(var x=0;x<w;x++){var sy=y;var sx=x;var dstOff=(y*w+x)*4;var r=0,g=0,b=0,a=0;for(var cy=0;cy<side;cy++){for(var cx=0;cx<side;cx++){var scy=Math.min(sh-1,Math.max(0,sy+cy-halfSide));var scx=Math.min(sw-1,Math.max(0,sx+cx-halfSide));var srcOff=(scy*sw+scx)*4;var wt=p_weights[cy*side+cx];r+=src[srcOff]*wt;g+=src[srcOff+1]*wt;b+=src[srcOff+2]*wt;a+=src[srcOff+3]*wt}}dst[dstOff]=r;dst[dstOff+1]=g;dst[dstOff+2]=b;dst[dstOff+3]=a+alphaFac*(255-a)}}return output};Filter.multiplyPixels=function(p_topValue,p_bottomValue){return p_topValue*p_bottomValue/255};Filter.createImageData=function(p_w,p_h){var _tmpCanvas=document.createElement("canvas");var _tmpCtx=_tmpCanvas.getContext("2d");return _tmpCtx.createImageData(p_w,p_h)};Filter.tableFilter=function(inputData,table,width,height){for(var y=0;y<height;y++){for(var x=0;x<width;x++){var pixel=(y*width+x)*4;for(var i=0;i<3;i++){inputData[pixel+i]=table[inputData[pixel+i]]}}}};window.Filter=Filter}(window));(function(b){DisplayObject=function(){};var a=DisplayObject.prototype=new EventTarget();a.constructor=DisplayObject;a.x=function(c){if(c!=null){this._x=c;return this}else{return this._x||1}};a.y=function(c){if(c!=null){this._y=c;return this}else{return this._y||1}};a.width=function(c){if(c){this._width=c;return this}else{return this._width}};a.height=function(c){if(c){this._height=c;return this}else{return this._height}};a.scale=function(c){if(c!=null){this._scale=c;return this}else{return this._scale||1}};a.rotate=function(c){if(c!=null){this._rotate=c;return this}else{return this._rotate||0}};a.filter=function(){if(arguments!=undefined&&arguments.length>0){this.resetFilter();this._filters=this._filters||[];var d={};d.args=[];d.effect=arguments[0];for(var c=1;c<arguments.length;c++){d.args.push(arguments[c])}this._filters[d.effect]=d;return this}else{return this._filters}};a.collides=function(e,f){var d=this,c=e;var g=d.x()<c.x()+c.width()&&d.x()+d.width()>c.x()&&d.y()<c.y()+c.height()&&d.y()+d.height()>c.y();if(g){f.call(this)}};a.resetFilter=function(){this.filter_cache=null};a.drag=function(c){return this.on("drag",c)};a._cleartrace=function(){if(this._trace_canvas){this._trace_canvas.canvas.width=this._trace_canvas.canvas.width}};a._transform_reset=function(){this.transform.save();this.transform.setMatrix([1,0,0,1,0,0])};b.DisplayObject=DisplayObject}(window));(function(b){Loop=function(c,d){$$_canvas.bind("draw",c,d||b);EventTarget.call(this)};var a=Loop.prototype=new EventTarget();a.constructor=Loop;b.Loop=Loop}(window));(function(b){Transform=function(c){this.context=c;this.matrix=[1,0,0,1,0,0];this.stack=[]};var a=Transform.prototype;a.setContext=function(c){this.context=c};a.getMatrix=function(){return this.matrix};a.setMatrix=function(c){this.matrix=[c[0],c[1],c[2],c[3],c[4],c[5]];this.setTransform()};a.cloneMatrix=function(c){return[c[0],c[1],c[2],c[3],c[4],c[5]]};a.save=function(){var c=this.cloneMatrix(this.getMatrix());this.stack.push(c);if(this.context){this.context.save()}};a.restore=function(){if(this.stack.length>0){var c=this.stack.pop();this.setMatrix(c)}if(this.context){this.context.restore()}};a.setTransform=function(){if(this.context){this.context.setTransform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5])}};a.translate=function(c,d){this.matrix[4]+=this.matrix[0]*c+this.matrix[2]*d;this.matrix[5]+=this.matrix[1]*c+this.matrix[3]*d;this.setTransform()};a.rotate=function(d){var j=Math.cos(d);var e=Math.sin(d);var g=this.matrix[0]*j+this.matrix[2]*e;var f=this.matrix[1]*j+this.matrix[3]*e;var i=this.matrix[0]*-e+this.matrix[2]*j;var h=this.matrix[1]*-e+this.matrix[3]*j;this.matrix[0]=g;this.matrix[1]=f;this.matrix[2]=i;this.matrix[3]=h;this.setTransform()};a.scale=function(d,c){this.matrix[0]*=d;this.matrix[1]*=d;this.matrix[2]*=c;this.matrix[3]*=c;this.setTransform()};a.rotateDegrees=function(d){var c=d*Math.PI/180;this.rotate(c)};a.rotateAbout=function(d,c,e){this.translate(c,e);this.rotate(d);this.translate(-c,-e);this.setTransform()};a.rotateDegreesAbout=function(d,c,e){this.translate(c,e);this.rotateDegrees(d);this.translate(-c,-e);this.setTransform()};a.identity=function(){this.matrix=[1,0,0,1,0,0];this.setTransform()};a.multiply=function(e){var g=this.matrix[0]*e.m[0]+this.matrix[2]*e.m[1];var f=this.matrix[1]*e.m[0]+this.matrix[3]*e.m[1];var i=this.matrix[0]*e.m[2]+this.matrix[2]*e.m[3];var h=this.matrix[1]*e.m[2]+this.matrix[3]*e.m[3];var d=this.matrix[0]*e.m[4]+this.matrix[2]*e.m[5]+this.matrix[4];var c=this.matrix[1]*e.m[4]+this.matrix[3]*e.m[5]+this.matrix[5];this.matrix[0]=g;this.matrix[1]=f;this.matrix[2]=i;this.matrix[3]=h;this.matrix[4]=d;this.matrix[5]=c;this.setTransform()};a.invert=function(){var i=1/(this.matrix[0]*this.matrix[3]-this.matrix[1]*this.matrix[2]);var h=this.matrix[3]*i;var g=-this.matrix[1]*i;var f=-this.matrix[2]*i;var e=this.matrix[0]*i;var c=i*(this.matrix[2]*this.matrix[5]-this.matrix[3]*this.matrix[4]);var j=i*(this.matrix[1]*this.matrix[4]-this.matrix[0]*this.matrix[5]);this.matrix[0]=h;this.matrix[1]=g;this.matrix[2]=f;this.matrix[3]=e;this.matrix[4]=c;this.matrix[5]=j;this.setTransform()};a.transformPoint=function(c,d){return{x:c*this.matrix[0]+d*this.matrix[2]+this.matrix[4],y:c*this.matrix[1]+d*this.matrix[3]+this.matrix[5]}};b.Transform=Transform}(window));(function(b){Events=function(c){b.$$_EVENTS_CHILDREN=b.$$_EVENTS_CHILDREN||[];b.$$_EVENTS_DRAG_CHILDREN=b.$$_EVENTS_DRAG_CHILDREN||[]};var a=Events.prototype;a.constructor=Events;a.on=function(d,c){$$_EVENTS_CHILDREN.push({object:this,event:d,callback:c});return this};b.Events=Events}(window));(function(b){Bitmap=function(c){EventTarget.call(this);this._context=c;this.extend(this,new Events());this.extend(this,new Animate());this.transform=new Transform(this._context);this._lastDrawState=""};var a=Bitmap.prototype=new DisplayObject();a.constructor=Bitmap;a.init=function(){this.x(0);this.y(0)};a.src=function(c){if(c){this._src=c;this._loadsrc(this._src);return this}else{return this._src}};a.draw=function(f){var d,c=(this.width()/this.orig_width),e=(this.height()/this.orig_height);this._transform_reset();this.fire("beginDraw");if(this.trace()){d=this._handle_trace(c,e,this._src,"initial")}else{d=this._handle_basic(c,e)}d=this._handle_filters(d);this.transform.context.drawImage(d,0,0);this._lastDrawState=d;this.transform.restore();this.fire("finishDraw");return this};a.toDataURL=function(d){this._dataurl_canvas=this._dataurl_canvas||Util.createContext("dataurl_"+this.id());this._dataurl_transform=this._dataurl_transform||new Transform(this._dataurl_canvas.context);if(!d){this._dataurl_canvas.canvas.width=this.width();this._dataurl_canvas.canvas.height=this.height()}this._dataurl_transform.save();this._dataurl_transform.setMatrix([1,0,0,1,0,0]);this._dataurl_canvas.context.clearRect(0,0,this._dataurl_canvas.canvas.width,this._dataurl_canvas.canvas.height);this._dataurl_transform.translate(this.x(),this.y());var c=(this.width()/this.orig_width),f=(this.height()/this.orig_height),e=this._dataurl_transform.getMatrix();if(d!=null){this._dataurl_canvas.context.drawImage(b.$$_canvas.canvas(),0,0)}else{this._dataurl_transform.rotate(this.rotate());this._dataurl_transform.scale((this.width()/this.orig_width)*this.scale(),(this.height()/this.orig_height)*this.scale());this._dataurl_transform.context.globalAlpha=this.alpha();this._applyShadow(this._dataurl_transform.context);this._dataurl_canvas.context.drawImage(this._lastDrawState,0,0)}return this._dataurl_canvas.canvas.toDataURL()};a.mouseDraw=function(){this._mouse_canvas=this._mouse_canvas||Util.createContext("mouse_"+this.id());this._mouse_transform=this._mouse_transform||new Transform(this._mouse_canvas.context);this._mouse_transform.save();this._mouse_transform.setMatrix([1,0,0,1,0,0]);this._mouse_canvas.context.clearRect(0,0,this._mouse_canvas.canvas.width,this._mouse_canvas.canvas.height);this._mouse_transform.translate(this.x(),this.y());var c=(this.width()/this.orig_width),e=(this.height()/this.orig_height),d=this._mouse_transform.getMatrix();this._mouse_transform.rotate(this.rotate());this._mouse_transform.scale((this.width()/this.orig_width)*this.scale(),(this.height()/this.orig_height)*this.scale());this._mouse_transform.context.globalAlpha=this.alpha();this._applyShadow(this._mouse_transform.context);this._mouse_canvas.context.drawImage(this._src,0,0);return this._mouse_canvas.context};a.trace=function(c){if(c===false){this._cleartrace()}if(c!=null){this._trace=c;return this}else{return this._trace||false}};a._loadsrc=function(c){(function(f,e){var d=new Image();d.src=e;d.onload=function(){f.orig_width=d.width;f.orig_height=d.height;f.width(f.width()||d.width);f.height(f.height()||d.height);f._src=d;f.fire("loaded");f.bind("draw",f.draw,f);f.ready(true)}})(this,c)};a._handle_filters=function(c){var e;if(this.filter()&&!this.filter_cache){if(this._filter_canvas){Util.removeElement(this._filter_canvas.canvas.id)}this._filter_canvas=this._filter_canvas||Util.createContext("filter_"+this.id());this._filter_canvas.canvas.width=this.orig_width;this._filter_canvas.canvas.height=this.orig_height;if(this.trace()){this._filter_canvas.context.drawImage(c,-this.x(),-this.y())}else{this._filter_canvas.context.drawImage(c,0,0)}for(var d in this.filter()){e=Filter.get(this._filter_canvas,this.filter()[d],this);this.filter_cache=e}}else{if(this.filter_cache){e=this.filter_cache}else{e=c}}if(this.trace()&&this.filter()){e=this._handle_trace(1,1,e,"filter")}return e};a._handle_trace=function(h,d,c,f){var e=this["trace_"+this.id()+"_"+f]||Util.createContext("trace_"+this.id()+"_"+f);this["trace_"+this.id()+"_"+f]=e;var g=this["trace_transfrom_"+this.id()+"_"+f]||new Transform(e.context);this["trace_transfrom_"+this.id()+"_"+f]=g;g.save();g.setMatrix([1,0,0,1,0,0]);g.translate(this.x(),this.y());g.rotate(this.rotate());g.scale(h*this.scale(),d*this.scale());g.context.globalAlpha=this.alpha();this._applyStroke(e.context,{x:0,y:0,w:this.orig_width,h:this.orig_height});this._applyShadow(g.context);e.context.drawImage(c,0,0);return e.canvas};a._handle_basic=function(d,c){this.transform.context.globalAlpha=this.alpha();this._applyStroke(this.transform.context,{x:this.x(),y:this.y(),w:this.width(),h:this.height()});this.transform.translate(this.x(),this.y());this.transform.rotate(this.rotate());this.transform.scale(d*this.scale(),c*this.scale());this._applyShadow(this.transform.context);return this._src};a.name="Bitmap Instance";b.Bitmap=Bitmap}(window));(function(b){Path=function(c){EventTarget.call(this);this._paths=this._paths||[];this._context=c;this.transform=new Transform(this._context)};var a=Path.prototype=new EventTarget();a.constructor=Path;a.init=function(){this.bind("draw",this.draw,this)};a.width=function(c){if(c){this._width=c;return this}else{return this._width}};a.color=function(c){if(c!=null){this._color=c;return this}else{return this._color||"#000"}};a.beginPath=function(d,c){this._p_startX=d;this._p_startY=c;return this};a.style=function(c){if(c.width){this.width(c.width)}if(c.color){this.color(c.color)}return this};a.to=function(d,c){this._paths.push({x:d,y:c});return this};a.end=function(c){if(c!=null){this._end=c;return this}else{return this._end||false}};a.draw=function(c){this.transform.save();this.transform.setMatrix([1,0,0,1,0,0]);this.transform.context.beginPath();this.transform.context.moveTo(this._p_startX,this._p_startY);for(var d=0;d<this._paths.length;d++){if(this._paths[d]!=null){this.transform.context.lineTo(this._paths[d].x,this._paths[d].y)}}this.transform.context.strokeStyle=this.color()||"#000";this.transform.context.lineWidth=this.width()||1;this.transform.context.globalAlpha=this.alpha();this._applyShadow(this.transform.context);if(this.end()){this.transform.context.closePath()}this.transform.context.stroke();this.transform.restore();return this};a.name="Path Instance";b.Path=Path}(window));(function(b){Sprite=function(c){EventTarget.call(this);this._context=c;this.extend(this,new Events());this.extend(this,new Animate());this.transform=new Transform(this._context);this.iterate=0;this._sequences={};this._curSequence=null;this._stopindex=null};var a=Sprite.prototype=new Bitmap();a.constructor=Sprite;a.src=function(d,c){if(d&&c){Util.getJSON(c,function(e){this._src=d;this.frames=e.frames;this._curSequence={start:0,end:this.frames.length};this._loadsrc(this._src)},this);return this}else{return this._src}};a.draw=function(f){var d,c=(this.width()/this.orig_width),e=(this.height()/this.orig_height);this._transform_reset();this.fire("beginDraw");d=this._handle_sprite(this._src);if(this.trace()){d=this._handle_trace(c,e,d,"initial")}else{this._handle_basic(c,e)}this.resetFilter();d=this._handle_filters(d);this.transform.context.drawImage(d,0,0);this.transform.restore();this._lastDrawState=d;this.fire("finishDraw");return this};a._handle_sprite=function(d){var i,h,j,g,f,e,c;this._sprite_canvas=this._sprite_canvas||Util.createContext("sprite_"+this.id());if(this.iterate<this._curSequence.end-1){if(this.gotoAndStop()!==null){this.iterate=this.gotoAndStop()}else{this.iterate++}}else{}h=this.frames[this.iterate].frame.w+this.padding();j=this.frames[this.iterate].frame.h+this.padding();g=this.frames[this.iterate].frame.x;f=this.frames[this.iterate].frame.y;e=this._sprite_canvas.context;c=this._sprite_canvas.canvas;c.width=h;c.height=j;if(!this._src_sprite){this._src_sprite=this._src;this._src=c}e.clearRect(0,0,c.width,c.height);i=e.drawImage(this._src_sprite,-g,-f);if(this.iterate===this._curSequence.end-1&&this.loop()){this.iterate=this._curSequence.start}return c};a.loop=function(c){if(c!=null){this._loop=c;return this}else{return this._loop||false}};a.padding=function(c){if(c!=null){this._padding=c;return this}else{return this._padding||0}};a.gotoAndStop=function(c){if(c!=null){if(typeof c==="string"){this._stopindex=this._sequences[c].end}else{this._curSequenceName="";this._stopindex=c}return this}else{return this._stopindex}};a.gotoAndPlay=function(c){if(c!=null){if(typeof c==="string"){this.run(c)}else{this.iterate=c}this._stopindex=null;return this}else{return this._stopindex}return this};a.sequence=function(c,d,e){this._sequences[c]={start:d,end:e};return this};a.run=function(c,e){if(this._curSequenceName!=c){var d=this._sequences[c];d.start=parseFloat(d.start);d.end=parseFloat(d.end);this._curSequence=d;this._stopindex=null;if(this._curSequence.start!=this._sequences[c].start||this._curSequence.start===0){this.iterate=d.start;this._curSequenceName=c}if(e===true){this.loop(true)}}return this};a.name="Sprite Instance";b.Sprite=Sprite}(window));(function(b){Rectangle=function(c){EventTarget.call(this);this._context=c;this.extend(this,new Events());this.extend(this,new Animate());this.transform=new Transform(this._context)};var a=Rectangle.prototype=new DisplayObject();a.constructor=Rectangle;a.init=function(){this.x(0);this.y(0);this.ready(true);this.bind("draw",this.draw,this)};a.draw=function(c){this._transform_reset();this.fire("beginDraw");this.transform.translate(this.x(),this.y());this.transform.rotate(this.rotate());this.transform.scale(1*this.scale(),1*this.scale());this.transform.context.fillStyle=this.color();this.transform.context.globalAlpha=this.alpha();this._applyShadow(this.transform.context);this.transform.context.fillRect(0,0,this.width(),this.height());this.transform.restore();this.fire("finishDraw");return this};a.mouseDraw=function(){this._mouse_canvas=this._mouse_canvas||Util.createContext("mouse_"+this.id());this._mouse_transform=this._mouse_transform||new Transform(this._mouse_canvas.context);this._mouse_transform.save();this._mouse_transform.setMatrix([1,0,0,1,0,0]);this._mouse_canvas.context.clearRect(0,0,this._mouse_canvas.canvas.width,this._mouse_canvas.canvas.height);this._mouse_transform.translate(this.x(),this.y());var c=(this.width()/this.orig_width),e=(this.height()/this.orig_height),d=this._mouse_transform.getMatrix();this._mouse_transform.rotate(this.rotate());this._mouse_transform.scale((this.width()/this.orig_width)*this.scale(),(this.height()/this.orig_height)*this.scale());this._mouse_transform.context.globalAlpha=this.alpha();this._applyShadow(this._mouse_transform.context);this._mouse_canvas.context.fillStyle=this.color();this._mouse_canvas.context.globalAlpha=this.alpha();this._mouse_canvas.context.fillRect(0,0,this.width(),this.height());return this._mouse_canvas.context};a.color=function(c){if(c!=null){this._color=c;return this}else{return this._color}};a.name="Rectangle Instance";b.Rectangle=Rectangle}(window));(function(b){FrameTicker=function(){this.timerID=0;this.timers=[];this.on=true;EventTarget.call(this)};var a=FrameTicker.prototype=new EventTarget();a.constructor=FrameTicker;a.start=function(c){if(this.timerID){return}var d=this;(function(){d.fire("tick");if(d.on){d.timerID=setTimeout(arguments.callee,c)}})();return d};a.stop=function(){this.on=false};b.FrameTicker=FrameTicker}(window));(function(window){function Tweenie(){var _scope=this}function Tween_runner(p_tween,p_home){EventTarget.call(this);this.on=true;this.tween=p_tween;this.id=p_tween.what.id;this._home=p_home;var _this=this;(function(){var obj,elapsed,ease_val,c_time,calculation,obj_delta;c_time=Date.now();obj=p_tween;obj.what._animating=true;for(var property in obj.props){elapsed=((c_time-obj.start_time)/obj.duration);elapsed=elapsed>1?1:elapsed;ease_val=eval("Easing."+obj.easing+"("+elapsed+")");calculation=obj.distance["start_"+property]+obj.distance["delta_"+property]*ease_val;if(elapsed!=1){obj.what[property](calculation)}if(obj.callback&&elapsed===1){if(_this.on==true){obj.callback.call(obj.what);_this.fire("finished")}obj.what._animating=false;_this.on=false}else{if(obj.update){var o={};for(var p in obj.props){o[p]=obj.what[p]}obj.update.call(obj.what,o)}else{if(elapsed===1){_this.fire("finished");_this.on=false;obj.what._animating=false}}}}if(_this.on){_this.timerID=setTimeout(arguments.callee,$$_canvas.framerate())}else{_this.fire("finished");obj.what._animating=false}})()}var _pt=Tween_runner.prototype=new EventTarget();var _pt=Tweenie.prototype;_pt._tweens=[];_pt.to=function(p_what,p_props,p_time,p_easing,p_update,p_callback,p_delay){var _temp_id=("id_"+p_what.id());if(this._tweens.hasOwnProperty("id_"+p_what.id())){this._tweens[_temp_id].on=false}var delta_start={};for(var property in p_props){delta_start["start_"+property]=p_what[property]();delta_start["delta_"+property]=p_props[property]-p_what[property]()}var _start_time=Date.now()+(p_delay?p_delay:0);var temp_tween=new Tween_runner({what:p_what,start_time:_start_time,duration:p_time,easing:p_easing,props:p_props,distance:delta_start,update:p_update,callback:p_callback},this);this._tweens[_temp_id]=temp_tween;temp_tween.bind("finished",this._cleanup,temp_tween)};_pt.stop=function(p_what){if(p_what.id>=0){for(var i=0;i<this._tweens.length;i++){if(this._tweens[i].id==p_what.id){this._tweens[i].on=false}}}};_pt._cleanup=function(p_obj){var _tweens=this._home._tweens;for(key in _tweens){if(_tweens.hasOwnProperty(key)){if(_tweens[key].id==this.id){delete _tweens[key]}}}};Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};Easing.Linear.EaseNone=function(p_e){return p_e};Easing.none=function(p_e){return p_e};Easing.Quadratic.EaseIn=function(p_e){return p_e*p_e};Easing.Quadratic.EaseOut=function(p_e){return -p_e*(p_e-2)};Easing.Quadratic.EaseInOut=function(p_e){if((p_e*=2)<1){return 0.5*p_e*p_e}return -0.5*(--p_e*(p_e-2)-1)};Easing.Cubic.EaseIn=function(p_e){return p_e*p_e*p_e};Easing.Cubic.EaseOut=function(p_e){return --p_e*p_e*p_e+1};Easing.Cubic.EaseInOut=function(p_e){if((p_e*=2)<1){return 0.5*p_e*p_e*p_e}return 0.5*((p_e-=2)*p_e*p_e+2)};Easing.Quartic.EaseIn=function(p_e){return p_e*p_e*p_e*p_e};Easing.Quartic.EaseOut=function(p_e){return -(--p_e*p_e*p_e*p_e-1)};Easing.Quartic.EaseInOut=function(p_e){if((p_e*=2)<1){return 0.5*p_e*p_e*p_e*p_e}return -0.5*((p_e-=2)*p_e*p_e*p_e-2)};Easing.Quintic.EaseIn=function(p_e){return p_e*p_e*p_e*p_e*p_e};Easing.Quintic.EaseOut=function(p_e){return(p_e=p_e-1)*p_e*p_e*p_e*p_e+1};Easing.Quintic.EaseInOut=function(p_e){if((p_e*=2)<1){return 0.5*p_e*p_e*p_e*p_e*p_e}return 0.5*((p_e-=2)*p_e*p_e*p_e*p_e+2)};Easing.Sinusoidal.EaseIn=function(p_e){return -Math.cos(p_e*Math.PI/2)+1};Easing.Sinusoidal.EaseOut=function(p_e){return Math.sin(p_e*Math.PI/2)};Easing.Sinusoidal.EaseInOut=function(p_e){return -0.5*(Math.cos(Math.PI*p_e)-1)};Easing.Exponential.EaseIn=function(p_e){return p_e==0?0:Math.pow(2,10*(p_e-1))};Easing.Exponential.EaseOut=function(p_e){return p_e==1?1:-Math.pow(2,-10*p_e)+1};Easing.Exponential.EaseInOut=function(p_e){if(p_e==0){return 0}if(p_e==1){return 1}if((p_e*=2)<1){return 0.5*Math.pow(2,10*(p_e-1))}return 0.5*(-Math.pow(2,-10*(p_e-1))+2)};Easing.Circular.EaseIn=function(p_e){return -(Math.sqrt(1-p_e*p_e)-1)};Easing.Circular.EaseOut=function(p_e){return Math.sqrt(1- --p_e*p_e)};Easing.Circular.EaseInOut=function(p_e){if((p_e/=0.5)<1){return -0.5*(Math.sqrt(1-p_e*p_e)-1)}return 0.5*(Math.sqrt(1-(p_e-=2)*p_e)+1)};Easing.Elastic.EaseIn=function(p_e){var s,a=0.1,p=0.4;if(p_e==0){return 0}if(p_e==1){return 1}if(!p){p=0.3}if(!a||a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}return -(a*Math.pow(2,10*(p_e-=1))*Math.sin((p_e-s)*(2*Math.PI)/p))};Easing.Elastic.EaseOut=function(p_e){var s,a=0.1,p=0.4;if(p_e==0){return 0}if(p_e==1){return 1}if(!p){p=0.3}if(!a||a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}return(a*Math.pow(2,-10*p_e)*Math.sin((p_e-s)*(2*Math.PI)/p)+1)};Easing.Elastic.EaseInOut=function(p_e){var s,a=0.1,p=0.4;if(p_e==0){return 0}if(p_e==1){return 1}if(!p){p=0.3}if(!a||a<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}if((p_e*=2)<1){return -0.5*(a*Math.pow(2,10*(p_e-=1))*Math.sin((p_e-s)*(2*Math.PI)/p))}return a*Math.pow(2,-10*(p_e-=1))*Math.sin((p_e-s)*(2*Math.PI)/p)*0.5+1};Easing.Back.EaseIn=function(p_e){var s=1.70158;return p_e*p_e*((s+1)*p_e-s)};Easing.Back.EaseOut=function(p_e){var s=1.70158;return(p_e=p_e-1)*p_e*((s+1)*p_e+s)+1};Easing.Back.EaseInOut=function(p_e){var s=1.70158*1.525;if((p_e*=2)<1){return 0.5*(p_e*p_e*((s+1)*p_e-s))}return 0.5*((p_e-=2)*p_e*((s+1)*p_e+s)+2)};Easing.Bounce.EaseIn=function(p_e){return 1-Easing.Bounce.EaseOut(1-p_e)};Easing.Bounce.EaseOut=function(p_e){if((p_e/=1)<(1/2.75)){return 7.5625*p_e*p_e}else{if(p_e<(2/2.75)){return 7.5625*(p_e-=(1.5/2.75))*p_e+0.75}else{if(p_e<(2.5/2.75)){return 7.5625*(p_e-=(2.25/2.75))*p_e+0.9375}else{return 7.5625*(p_e-=(2.625/2.75))*p_e+0.984375}}}};Easing.Bounce.EaseInOut=function(p_e){if(p_e<0.5){return Easing.Bounce.EaseIn(p_e*2)*0.5}return Easing.Bounce.EaseOut(p_e*2-1)*0.5+0.5};window.Easing=Easing;window.Tweenie=Tweenie}(window));(function(b){Canvas=function(c){EventTarget.call(this);this._canvas=document.getElementById(c);this._canvas.width=this.canvas().getAttribute("width")||b.innerWidth;this._canvas.height=this.canvas().getAttribute("height")||b.innerHeight;if(!this._canvas||!this._canvas.getContext){throw"No Canvas Support."}this.context(this._canvas.getContext("2d"));this.context().translate(0,0);this.framerate(this.canvas().getAttribute("framerate")||0);this._engine=new FrameTicker();this._engine.start(this.framerate()).bind("tick",this._childrenDraw,this);this.init()};var a=Canvas.prototype=new EventTarget();a.constructor=Canvas;a.init=function(){HTMLCanvasElement.prototype.relMouseCoords=function(d){var e=0;totalOffsetY=0;canvasX=0;canvasY=0;currentElement=this;do{e+=currentElement.offsetLeft;totalOffsetY+=currentElement.offsetTop}while(currentElement=currentElement.offsetParent);canvasX=d.pageX-e;canvasY=d.pageY-totalOffsetY;canvasX=Math.round(canvasX*(this.width/this.offsetWidth));canvasY=Math.round(canvasY*(this.height/this.offsetHeight));return{x:canvasX,y:canvasY}};var c=this;if(document.addEventListener){document.addEventListener("mouseup",function(d){c._MouseUpHandler(d)},false);document.addEventListener("mousemove",function(d){c._MouseMoveHandler(d)},false);document.addEventListener("onkeydown",function(d){c._keyDownHandler(d)},false);document.onkeydown=c._keyDownHandler;document.onkeypress=c._keyDownHandler;document.onkeyup=c._keyDownHandler}else{if(b.addEventListener){b.addEventListener("mouseup",function(d){c._MouseUpHandler(d)},false);b.addEventListener("mousemove",function(d){c._MouseMoveHandler(d)},false);b.addEventListener("onkeydown",function(d){c._keyDownHandler(d)},false);b.onkeydown=c._keyDownHandler;b.onkeypress=c._keyDownHandler;b.onkeyup=c._keyDownHandler}}this._canvas.addEventListener("mousedown",function(d){c._MouseDownHandler(d)},false)};a.width=function(c){if(c){this._width=c;return this}else{return this._width}};a.height=function(c){if(c){this._height=c;return this}else{return this._height}};a.framerate=function(c){if(c){this._framerate=c;return this}else{return this._framerate||6}};a.context=function(c){if(c){this._context=c;return this}else{return this._context||""}};a.canvas=function(c){if(c){this._canvas=c;return this}else{return this._canvas}};a._childrenDraw=function(){this.fire("draw");this.context().clearRect(0,0,this._canvas.width,this._canvas.height);for(var c=0;c<$$_CHILDREN.length;c++){if($$_CHILDREN[c].visible()){$$_CHILDREN[c].fire("draw")}}};a._keyDownHandler=function(c){for(var d=$$_EVENTS_CHILDREN.length-1;d>=0;d--){if($$_EVENTS_CHILDREN[d].event===c.type){$$_EVENTS_CHILDREN[d].callback.call($$_EVENTS_CHILDREN[d].object,c)}}};a._MouseDownHandler=function(j,l){var e=this.canvas().relMouseCoords(j),h=e.x,g=e.y,d=this;for(var k=$$_EVENTS_CHILDREN.length-1;k>=0;k--){if($$_EVENTS_CHILDREN[k].event==="click"){if(Util.checkPIXEL($$_EVENTS_CHILDREN[k].object,h,g)){$$_EVENTS_CHILDREN[k].callback.call($$_EVENTS_CHILDREN[k].object)}}if($$_EVENTS_CHILDREN[k].event==="drag"&&!$$_EVENTS_DRAG_CHILDREN[$$_EVENTS_CHILDREN[k].object.id()+"_obj"]){if(Util.checkPIXEL($$_EVENTS_CHILDREN[k].object,h,g)){var c=$$_EVENTS_DRAG_CHILDREN[($$_EVENTS_CHILDREN[k].object.id()+"_obj")]=$$_EVENTS_CHILDREN[k];c.clickX=h;c.clickY=g;c.pastX=c.object.x();c.pastY=c.object.y();$$_EVENTS_CHILDREN[k].callback.call($$_EVENTS_CHILDREN[k].object,{eventType:"onStart"});return}}}};a._MouseUpHandler=function(c){for(obj in $$_EVENTS_DRAG_CHILDREN){if($$_EVENTS_DRAG_CHILDREN[obj].event==="drag"){$$_EVENTS_DRAG_CHILDREN[obj].callback.call($$_EVENTS_DRAG_CHILDREN[obj].object,{eventType:"onFinished"});delete $$_EVENTS_DRAG_CHILDREN[obj]}}};a._MouseMoveHandler=function(l){var f=this.canvas().relMouseCoords(l),j=f.x,h=f.y,e=this,d,c;for(var g=$$_EVENTS_CHILDREN.length-1;g>=0;g--){if($$_EVENTS_CHILDREN[g].event==="hover"){if(Util.checkPIXEL($$_EVENTS_CHILDREN[g].object,j,h)){$$_EVENTS_CHILDREN[g].callback.call($$_EVENTS_CHILDREN[g].object)}}}for(obj in $$_EVENTS_DRAG_CHILDREN){if($$_EVENTS_DRAG_CHILDREN[obj].event==="drag"){var k=$$_EVENTS_DRAG_CHILDREN[obj];d=j-Math.abs(k.pastX-k.clickX);c=h-Math.abs(k.pastY-k.clickY);k.object.x(d);k.object.y(c);$$_EVENTS_DRAG_CHILDREN[obj].callback.call(k.object,{eventType:"onUpdate"});k.clickX=j;k.clickY=h;k.pastX=k.object.x();k.pastY=k.object.y()}}};b.Canvas=Canvas}(window));(function(window){Element=function(p_class,p_def){if(p_class){window.$$_CHILDREN=window.$$_CHILDREN||[];window.$$_TWEENS=window.$$_TWEENS||{};window.$$_canvas=window.$$_canvas||new Canvas(this.canvas_id()||"element-root");var _temp=eval("new "+p_class+"(window.$$_canvas.context())");_temp=this.extend(_temp,new Element());_temp.id((window.$$_CHILDREN.length)+"_id");_temp.index((window.$$_CHILDREN.length));_temp.visible(true);_temp.alpha(1);_temp._tweenie=new Tweenie();if(typeof _temp.init==="function"){_temp.init()}window.$$_CHILDREN.push(_temp);_temp._handelDefinition(p_def,_temp);return _temp}};var _pt=Element.prototype=new Basic();_pt.alpha=function(p_val){if(p_val!=null){this._alpha=p_val;return this}else{return this._alpha}};_pt.visible=function(p_val){if(p_val!=null){this._visible=p_val;return this}else{return this._visible}};_pt.mask=function(p_val){if(p_val){this._mask=p_val;return this}else{return this._mask}};_pt.id=function(p_val){if(p_val){this._id=p_val;return this}else{return this._id}};_pt.canvas_id=function(p_val){if(p_val){this._id=p_val;return this}else{return this._id}};_pt.index=function(p_val){if(p_val!=null){this._index=p_val;return this}else{return this._index}};_pt.ready=function(p_val){if(p_val){this._ready=p_val;return this}else{return this._ready||false}};_pt.shadow=function(p_val){if(p_val){this._shadow=p_val;return this}else{return this._shadow||{}}};_pt.border=function(p_val){if(p_val){this._border=p_val;return this}else{return this._border||{width:0,color:null}}};_pt.top=function(){var _i=Util.getIndex(this);var _childtotop=$$_CHILDREN.splice(_i,1);$$_CHILDREN.push(_childtotop[0]);return this};_pt.bottom=function(){var _i=Util.getIndex(this);var _childtotop=$$_CHILDREN.splice(_i,1);$$_CHILDREN.unshift(_childtotop[0]);return this};_pt.toString=function(){return"["+this.name+" Instance]"};_pt._applyStroke=function(p_context,p_cords){if(this.border().color!=null){var _c=p_context,_b=this.border(),loc=p_cords;_c.beginPath();_c.rect(loc.x,loc.y,loc.w,loc.h);_c.strokeStyle=_b.color;_c.lineWidth=_b.width;_c.closePath();_c.stroke()}};_pt._applyShadow=function(p_context){if(this.shadow().color!=null){var _c=p_context,_s=this.shadow(),_color=Util.hexToRGB(_s.color);_c.shadowColor="rgba("+_color.r+", "+_color.b+", "+_color.g+", "+(_s.alpha||1)+")";_c.shadowBlur=_s.blur;_c.shadowOffsetX=_s.x;_c.shadowOffsetY=_s.y}};_pt._handelDefinition=function(p_def,p_ele){if(p_def!=null){var _multi_func,_args=[],_f;for(var prop in p_def){if(prop==="filter"||prop==="sequence"){_multi_func=p_def[prop].split(",");for(var i=0;i<_multi_func.length;i++){_args=_multi_func[i].split(":");if(_args.length>1){p_ele[prop].apply(p_ele,_args)}else{p_ele[prop](_multi_func[i])}}}else{_args=typeof p_def[prop]=="string"?p_def[prop].split(","):p_def[prop];if(_args.length>1){p_ele[prop].apply(p_ele,_args)}else{p_ele[prop](p_def[prop])}}}}};window.Element=Element}(window));