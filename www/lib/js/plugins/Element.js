(function(window){function loadXMLDoc(){}Util=window.Util||function(){};Util.hexToRGB=function(e){this.cache=this.cache||[];if(this.cache[e])return this.cache[e];var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);var n=t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null;this.cache[e]=n;return n};Util.RGBtoHSV=function(e,t,n){e=e/255;t=t/255;n=n/255;var r=Math.max(e,t,n);var i=Math.min(e,t,n);var s,o,u=r;var a=r-i;o=r===0?0:a/r;if(r===i){s=0}else{switch(r){case e:s=(t-n)/a+(t<n?6:0);break;case t:s=(n-e)/a+2;break;case n:s=(e-t)/a+4;break;default:break}s/=6}return[s,o,u]};Util.HSVtoRGB=function(e,t,n){var r,i,s;var o=Math.floor(e*6);var u=e*6-o;var a=n*(1-t);var f=n*(1-u*t);var l=n*(1-(1-u)*t);switch(o%6){case 0:r=n;i=l;s=a;break;case 1:r=f;i=n;s=a;break;case 2:r=a;i=n;s=l;break;case 3:r=a;i=f;s=n;break;case 4:r=l;i=a;s=n;break;case 5:r=n;i=a;s=f;break;default:break}return[r*255,i*255,s*255]};Util.mixColors=function(e,t,n){var r=Util.linearInterpolate(e,t[0],n[0]);var i=Util.linearInterpolate(e,t[1],n[1]);var s=Util.linearInterpolate(e,t[2],n[2]);var o=Util.linearInterpolate(e,t[3],n[3]);return[r,i,s,o]};Util.linearInterpolate=function(e,t,n){return t+e*(n-t)};Util.createContext=function(e){var t=document.createElement("canvas");t.setAttribute("id","element-canvas_"+e);$$_canvas.canvas().appendChild(t);t.style.display="none";t.width=$$_canvas._canvas.width;t.height=$$_canvas._canvas.height;return{canvas:t,context:t.getContext("2d")}};Util.removeElement=function(e){var t=document.getElementById(e);if(t)t.parentNode.removeChild(t);return true};Util.checkPIXEL=function(e,t,n){var r=e.mouseDraw();var i=r.getImageData(t,n,1,1);var s=(t+n*i.width)*4;if(i.data[3]>0){return true}return false};Util.getPixel=function(e,t,n,r,i){var s=(n*r+t)*4;if(t<0||t>=r||n<0||n>=i){return[e[(Util.clampPixel(n,0,i-1)*r+Util.clampPixel(t,0,r-1))*4],e[(Util.clampPixel(n,0,i-1)*r+Util.clampPixel(t,0,r-1))*4+1],e[(Util.clampPixel(n,0,i-1)*r+Util.clampPixel(t,0,r-1))*4+2],e[(Util.clampPixel(n,0,i-1)*r+Util.clampPixel(t,0,r-1))*4+3]]}return[e[s],e[s+1],e[s+2],e[s+3]]};Util.clampPixel=function(e,t,n){return e<t?t:e>n?n:e};Util.bilinearInterpolate=function(e,t,n,r,i,s){var o,u;var a=n[0];var f=n[1];var l=n[2];var c=n[3];var h=r[0];var p=r[1];var d=r[2];var v=r[3];var m=i[0];var g=i[1];var y=i[2];var b=i[3];var w=s[0];var E=s[1];var S=s[2];var x=s[3];var T=1-e;var N=1-t;o=T*c+e*v;u=T*b+e*x;var C=N*o+t*u;o=T*a+e*h;u=T*m+e*w;var k=N*o+t*u;o=T*f+e*p;u=T*g+e*E;var L=N*o+t*u;o=T*l+e*d;u=T*y+e*S;var A=N*o+t*u;return[k,L,A,C]};Util.triangle=function(e){var t=Util.mod(e,1);return 2*(t<.5?t:1-t)};Util.mod=function(e,t){var n=parseInt(e/t,10);e-=n*t;if(e<0){return e+t}return e};Util.getIndex=function(e){var t;for(var n=0;n<$$_CHILDREN.length;n++){if(e.id()==$$_CHILDREN[n].id())t=n}return t};Util.getJSON=function(p_path,p_callback,p_scope){var xmlhttp,scope;scope=p_scope||this;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){try{var json=JSON.parse(xmlhttp.responseText)}catch(e){var json=eval("("+xmlhttp.responseText+")")}p_callback.call(p_scope,json)}};xmlhttp.open("GET",p_path,true);xmlhttp.send()};window.Util=Util})(window);(function(e){Basic=function(){};var t=Basic.prototype;t.constructor=Basic;t.extend=function(e,t){for(var n in t){e[n]=t[n]}return e};e.Basic=Basic})(window);(function(e){Animate=function(e){this._tween=[]};var t=Animate.prototype;t.easing=function(e){if(e){this._easing=e;return this}else{return this._easing}};t.time=function(e){if(e){this._time=e;return this}else{return this._time}};t.easing=function(e){if(e){this._easing=e;return this}else{return this._easing||"Linear.EaseNone"}};t.animate=function(e,t,n){this._tween.push({props:t,time:e,easing:n||this.easing()});return this};t.start=function(e){if(this.ready()===false){var t=this,n=e;setTimeout(function(){t.start(n)},1e3);return this}this._callback=e||"";this._tweenie.to(this,this._tween[0].props,this._tween[0].time*1e3,this._tween[0].easing,null,this._nextTween);return this};t.stop=function(){return this};t.pause=function(){return this};t._nextTween=function(){if(this._tween.length>1){this._tween.shift();this._tweenie.to(this,this._tween[0].props,this._tween[0].time*1e3,this._tween[0].easing,null,this._nextTween)}else{this._tween.shift();if(this._callback!=="")this._callback.call(this)}};e.Animate=Animate})(window);(function(e){EventTarget=function(){this._listeners={}};var t=EventTarget.prototype=new Basic;t.constructor=EventTarget;t.bind=function(e,t,n){if(typeof this._listeners[e]=="undefined"){this._listeners[e]=[]}this._listeners[e].push({fn:t,scope:n});return this};t.unbind=function(e,t){if(this._listeners[e]instanceof Array){var n=this._listeners[e];for(var r=0,i=n.length;r<i;r++){if(n[r].fn===t){n.splice(r,1);break}}}};t.fire=function(e,t){if(typeof e=="string"){e={type:e}}if(!e.target){e.target=this}if(!e.type){throw new Error("Event object missing 'type' property.")}if(t){e.params=t}if(this._listeners[e.type]instanceof Array){var n=this._listeners[e.type];for(var r=0,i=n.length;r<i;r++){n[r].fn.call(n[r].scope||this,e)}}};e.EventTarget=EventTarget})(window);(function(window){Filter=function(){EventTarget.call(this)};var _pt=Filter.prototype;_pt.constructor=Filter;Filter.get=function(e,t,n){var r;r=e.context.getImageData(0,0,e.canvas.width,e.canvas.height);r=Filter.filterImage(t.effect,r,t.args[0],n);e.context.putImageData(r,0,0);return e.canvas};Filter.filterImage=function(p_filter,p_image,var_args,p_ref){var args=[p_image];for(var i=2;i<arguments.length;i++){args.push(arguments[i])}args.push[p_ref];return eval("Filter."+p_filter+".apply(p_ref, args)")};Filter.grayscale=function(e){var t=e.data;for(var n=0;n<t.length;n+=4){var r=t[n];var i=t[n+1];var s=t[n+2];var o=.2126*r+.7152*i+.0722*s;t[n]=t[n+1]=t[n+2]=o}return e};Filter.brightness=function(e,t){var n=e.width,r=e.height;var i=e.data;var s=t||-1;for(var o=0;o<r;o++){for(var u=0;u<n;u++){var a=(o*n+u)*4;var f=Util.RGBtoHSV(i[a],i[a+1],i[a+2]);f[2]+=s;if(f[2]<0){f[2]=0}else if(f[2]>1){f[2]=1}var l=Util.HSVtoRGB(f[0],f[1],f[2]);for(var c=0;c<3;c++){i[a+c]=l[c]}}}return e};Filter.threshold=function(e,t){var n=e.data;for(var r=0;r<n.length;r+=4){var i=n[r];var s=n[r+1];var o=n[r+2];var u=.2126*i+.7152*s+.0722*o>=t?255:0;n[r]=n[r+1]=n[r+2]=u}return e};Filter.multiply=function(e,t){var n=e.data,r=Util.hexToRGB(t);for(var i=0,s=n.length;i<s;i+=4){n[i]=Filter.multiplyPixels(r.r,n[i]);n[i+1]=Filter.multiplyPixels(r.g,n[i+1]);n[i+2]=Filter.multiplyPixels(r.b,n[i+2])}return e};Filter.sharpen=function(e){return Filter.convolute(e,[0,-1,0,-1,5,-1,0,-1,0])};Filter.emboss=function(e){return Filter.convolute(e,[-2,-1,0,-1,1,1,0,1,2])};Filter.woodblock=function(e){var t=Filter.sobel.call(this,e);t=Filter.multiply.call(this,t,"#FF0000");t=Filter.threshold.call(this,t,5);return t};Filter.sobel=function(e){var t=e;var n=Filter.convoluteFloat32(t,[-1,-2,-1,0,0,0,1,2,1]);var r=Filter.convoluteFloat32(t,[-1,0,1,-2,0,2,-1,0,1]);var i=Filter.createImageData(n.width,n.height);for(var s=0;s<i.data.length;s+=4){var o=Math.abs(n.data[s]);i.data[s]=o;var u=Math.abs(r.data[s]);i.data[s+1]=u;i.data[s+2]=(o+u)/4;i.data[s+3]=255}return i};Filter.blur=function(e,t){var n=e.width;var r=n<<2;var i=e.height;var s=e.data;var o;var u=t;if(u<0){u=0}if(u>=2.5){o=.98711*u-.9633}else if(u>=.5){o=3.97156-4.14554*Math.sqrt(1-.26891*u)}else{o=2*u*(3.97156-4.14554*Math.sqrt(1-.26891*.5))}var a=o*o;var f=a*o;var l=1.57825+2.44413*o+1.4281*a+.422205*f;var c=(2.44413*o+2.85619*a+1.26661*f)/l;var h=-(1.4281*a+1.26661*f)/l;var p=.422205*f/l;var d=1-(c+h+p);var v=0;var m;var g;var y;var b;var w;var E;for(v=0;v<3;v++){for(var S=0;S<i;S++){m=S*r+v;g=S*r+(n-1<<2)+v;y=s[m];b=y;w=b;E=w;for(;m<=g;m+=4){y=d*s[m]+c*b+h*w+p*E;s[m]=y;E=w;w=b;b=y}m=S*r+(n-1<<2)+v;g=S*r+v;y=s[m];b=y;w=b;E=w;for(;m>=g;m-=4){y=d*s[m]+c*b+h*w+p*E;s[m]=y;E=w;w=b;b=y}}}for(v=0;v<3;v++){for(var x=0;x<n;x++){m=(x<<2)+v;g=(i-1)*r+(x<<2)+v;y=s[m];b=y;w=b;E=w;for(;m<=g;m+=r){y=d*s[m]+c*b+h*w+p*E;s[m]=y;E=w;w=b;b=y}m=(i-1)*r+(x<<2)+v;g=(x<<2)+v;y=s[m];b=y;w=b;E=w;for(;m>=g;m-=r){y=d*s[m]+c*b+h*w+p*E;s[m]=y;E=w;w=b;b=y}}}return e};Filter.median=function(e){var t=Filter.createImageData(e.width,e.height);for(var n=0;n<e.width;n++){for(var r=0;r<e.height;r++){var i=new Array;var s=0;for(var o=0;o<3;o++){for(var u=0;u<3;u++){var a=(n+o+(r+u)*e.width)*4;var f=e.data[a+0];var l=e.data[a+1];var c=e.data[a+2];var h=e.data[a+3];i[s]=parseInt(parseFloat("0.33")*(parseFloat(f)+parseFloat(l)+parseFloat(c)));s++}}i.sort();var p=(n+r*e.width)*4;t.data[p+0]=parseInt(i[4]);t.data[p+1]=parseInt(i[4]);t.data[p+2]=parseInt(i[4]);t.data[p+3]=e.data[p+3]}}return t};Filter.invert=function(e){var t=Filter.createImageData(e.width,e.height);var n=0;while(n<e.data.length){t.data[n]=255-e.data[n++];t.data[n]=255-e.data[n++];t.data[n]=255-e.data[n++];t.data[n]=e.data[n++]}return t};Filter.circleSmear=function(e,t){var n=e.width,r=e.height;var i=e.data;var s=[];for(var o=0;o<i.length;o++){s[o]=i[o]}var u=t||{size:5,density:.5,mix:.5};var a=u.size;if(a<1){a=1}a=parseInt(a,10);var f=u.density;var l=u.mix;var c=a+1;var h=c*c;var p=parseInt(2*f/30*n*r/2,10);for(var d=0;d<p;d++){var v=(Math.random()*Math.pow(2,32)&2147483647)%n;var m=(Math.random()*Math.pow(2,32)&2147483647)%r;var g=[i[(m*n+v)*4],i[(m*n+v)*4+1],i[(m*n+v)*4+2],i[(m*n+v)*4+3]];for(var y=v-c;y<v+c+1;y++){for(var b=m-c;b<m+c+1;b++){var w=(y-v)*(y-v)+(b-m)*(b-m);if(y>=0&&y<n&&b>=0&&b<r&&w<=h){var E=[s[(b*n+y)*4],s[(b*n+y)*4+1],s[(b*n+y)*4+2],s[(b*n+y)*4+3]];var S=Util.mixColors(l,E,g);for(var x=0;x<3;x++){s[(b*n+y)*4+x]=S[x]}}}}}for(var T=0;T<s.length;T++){i[T]=s[T]}return e};Filter.diffuse=function(e,t){var n=e.width,r=e.height;var i=e.data;var s=t;var o=[];var u=[];var a=[];var f=[];for(var l=0;l<256;l++){var c=Math.PI*2*l/256;a[l]=s*Math.sin(c);f[l]=s*Math.cos(c)}transInverse=function(e,t,n){var r=parseInt(Math.random()*255,10);var i=Math.random();n[0]=e+i*a[r];n[1]=t+i*f[r]};Filter.transformFilter(i,transInverse,n,r);return e};Filter.contrast=function(e,t){var n=e.width,r=e.height;var i=e.data;var s=t||2;if(s<0){s=0}var o=[];for(var u=0;u<256;u++){o[u]=parseInt(255*((u/255-.5)*s+.5),10)}Filter.tableFilter(i,o,n,r);return e};Filter.sepia=function(e){var t=e.data;for(var n=0;n<t.length;n+=4){var r=t[n],i=t[n+1],s=t[n+2];t[n]=r*.393+i*.769+s*.189;t[n+1]=r*.349+i*.686+s*.168;t[n+2]=r*.272+i*.534+s*.131}return e};Filter.dither=function(e,t){var n=e.width,r=e.height;var i=e.data;var s=[];var o,u;for(u=0;u<i.length;u++){s[u]=0}if(t===undefined){t={levels:3,color:true}}var a=t.levels;var f=t.color;if(a<=1){a=1}var l=[0,0,0,0,0,7,3,5,1];var c=7+3+5+1;var h=0;var p=[];for(o=0;o<a;o++){p[o]=parseInt(255*o/(a-1),10)}var d=[];for(o=0;o<256;o++){d[o]=parseInt(a*o/256,10)}for(var v=0;v<r;v++){var m=(v&1)==1;var g;if(m){h=(v*n+n-1)*4;g=-1}else{h=v*n*4;g=1}for(var y=0;y<n;y++){var b=i[h];var w=i[h+1];var E=i[h+2];if(!f){b=w=E=parseInt((b+w+E)/3,10)}var S=p[d[b]];var x=p[d[w]];var T=p[d[E]];s[h]=S;s[h+1]=x;s[h+2]=T;s[h+3]=i[h+3];var N=b-S;var C=w-x;var k=E-T;for(o=-1;o<=1;o++){var L=o+v;if(0<=L&&L<r){for(u=-1;u<=1;u++){var A=u+y;if(0<=A&&A<n){var O;if(m){O=l[(o+1)*3-u+1]}else{O=l[(o+1)*3+u+1]}if(O!==0){var M=m?h-u*4:h+u*4;b=i[M];w=i[M+1];E=i[M+2];var _=O/c;b+=N*_;w+=C*_;E+=k*_;i[M]=b;i[M+1]=w;i[M+2]=E}}}}}h+=g*4}}for(u=0;u<s.length;u++){i[u]=s[u]}return e};Filter.edge=function(e){var t=e.width,n=e.height;var r=e.data;var i=[];var s=[-1,-2,-1,0,0,0,1,2,1];var o=[-1,0,1,-2,0,2,-1,0,1];for(var u=0;u<n;u++){for(var a=0;a<t;a++){var f=(u*t+a)*4;var l=0;gh=0;bh=0;var c=0;gv=0;bv=0;for(var h=-1;h<=1;h++){var p=u+h;var d;if(p>=0&&p<n){d=p*t*4}else{d=u*t*4}var v=3*(h+1)+1;for(var m=-1;m<=1;m++){var g=a+m;if(!(g>=0&&g<t)){g=a}g*=4;var y=r[d+g];var b=r[d+g+1];var w=r[d+g+2];var E=s[v+m];var S=o[v+m];l+=parseInt(E*y,10);bh+=parseInt(E*b,10);gh+=parseInt(E*w,10);c+=parseInt(S*y,10);gv+=parseInt(S*b,10);bv+=parseInt(S*w,10)}}y=parseInt(Math.sqrt(l*l+c*c)/1.8,10);b=parseInt(Math.sqrt(gh*gh+gv*gv)/1.8,10);w=parseInt(Math.sqrt(bh*bh+bv*bv)/1.8,10);i[f]=y;i[f+1]=b;i[f+2]=w;i[f+3]=r[f+3]}}for(var x=0;x<i.length;x++){r[x]=i[x]}return e};Filter.kaleidoscope=function(e,t){var n=e.width,r=e.height;var i=e.data;var s={angle:0,rotation:0,sides:3,centerX:.5,centerY:.5};var o={angle:{min:0,max:360},rotation:{min:0,max:360},sides:{min:1,max:30},centerX:{min:0,max:1},centerY:{min:0,max:1}};if(t===undefined){t=s}var u=t.angle===undefined?s.angle:t.angle;var a=t.rotation===undefined?s.rotation:t.rotation;var f=t.sides===undefined?s.sides:t.sides;var l=t.centerX===undefined?s.centerX:t.centerX;var c=t.centerY===undefined?s.centerY:t.centerY;var h=n*l;var p=r*c;u=u/180*Math.PI;a=a/180*Math.PI;var d=function(e,t,n){var r=e-h;var i=t-p;var s=Math.sqrt(r*r+i*i);var o=Math.atan2(i,r)-u-a;o=Util.triangle(o/Math.PI*f*.5);o+=u;n[0]=h+s*Math.cos(o);n[1]=p+s*Math.sin(o)};Filter.transformFilter(i,d,n,r);return e};Filter.transformFilter=function(e,t,n,r){var i=[];var s=[];for(var o=0;o<e.length;o++){s[o]=e[o]}for(var u=0;u<r;u++){for(var a=0;a<n;a++){var f=(u*n+a)*4;t.apply(this,[a,u,i]);var l=Math.floor(i[0]);var c=Math.floor(i[1]);var h=i[0]-l;var p=i[1]-c;var d,v,m,g;if(l>=0&&l<n-1&&c>=0&&c<r-1){var y=(n*c+l)*4;d=[e[y],e[y+1],e[y+2],e[y+3]];v=[e[y+4],e[y+5],e[y+6],e[y+7]];m=[e[y+n*4],e[y+n*4+1],e[y+n*4+2],e[y+n*4+3]];g=[e[y+(n+1)*4],e[y+(n+1)*4+1],e[y+(n+1)*4+2],e[y+(n+1)*4+3]]}else{d=Util.getPixel(e,l,c,n,r);v=Util.getPixel(e,l+1,c,n,r);m=Util.getPixel(e,l,c+1,n,r);g=Util.getPixel(e,l+1,c+1,n,r)}var b=Util.bilinearInterpolate(h,p,d,v,m,g);s[f]=b[0];s[f+1]=b[1];s[f+2]=b[2];s[f+3]=b[3]}}for(var w=0;w<s.length;w++){e[w]=s[w]}};Filter.convolute=function(e,t,n){var r=Math.round(Math.sqrt(t.length));var i=Math.floor(r/2);var s=e.data;var o=e.width;var u=e.height;var a=o;var f=u;var l=Filter.createImageData(a,f);var c=l.data;var h=n?1:0;for(var p=0;p<f;p++){for(var d=0;d<a;d++){var v=p;var m=d;var g=(p*a+d)*4;var y=0,b=0,w=0,E=0;for(var S=0;S<r;S++){for(var x=0;x<r;x++){var T=Math.min(u-1,Math.max(0,v+S-i));var N=Math.min(o-1,Math.max(0,m+x-i));var C=(T*o+N)*4;var k=t[S*r+x];y+=s[C]*k;b+=s[C+1]*k;w+=s[C+2]*k;E+=s[C+3]*k}}c[g]=y;c[g+1]=b;c[g+2]=w;c[g+3]=E+h*(255-E)}}return l};Filter.convoluteFloat32=function(e,t,n){if(!window.Float32Array)Float32Array=Array;var r=Math.round(Math.sqrt(t.length));var i=Math.floor(r/2);var s=e.data;var o=e.width;var u=e.height;var a=o;var f=u;var l={width:a,height:f,data:new Float32Array(a*f*4)};var c=l.data;var h=n?1:0;for(var p=0;p<f;p++){for(var d=0;d<a;d++){var v=p;var m=d;var g=(p*a+d)*4;var y=0,b=0,w=0,E=0;for(var S=0;S<r;S++){for(var x=0;x<r;x++){var T=Math.min(u-1,Math.max(0,v+S-i));var N=Math.min(o-1,Math.max(0,m+x-i));var C=(T*o+N)*4;var k=t[S*r+x];y+=s[C]*k;b+=s[C+1]*k;w+=s[C+2]*k;E+=s[C+3]*k}}c[g]=y;c[g+1]=b;c[g+2]=w;c[g+3]=E+h*(255-E)}}return l};Filter.multiplyPixels=function(e,t){return e*t/255};Filter.createImageData=function(e,t){var n=document.createElement("canvas");var r=n.getContext("2d");return r.createImageData(e,t)};Filter.tableFilter=function(e,t,n,r){for(var i=0;i<r;i++){for(var s=0;s<n;s++){var o=(i*n+s)*4;for(var u=0;u<3;u++){e[o+u]=t[e[o+u]]}}}};window.Filter=Filter})(window);(function(e){DisplayObject=function(){};var t=DisplayObject.prototype=new EventTarget;t.constructor=DisplayObject;t.x=function(e){if(e!=null){this._x=e;return this}else{return this._x||1}};t.y=function(e){if(e!=null){this._y=e;return this}else{return this._y||1}};t.width=function(e){if(e){this._width=e;return this}else{return this._width}};t.height=function(e){if(e){this._height=e;return this}else{return this._height}};t.scale=function(e){if(e!=null){this._scale=e;return this}else{return this._scale||1}};t.rotate=function(e){if(e!=null){this._rotate=e;return this}else{return this._rotate||0}};t.filter=function(){if(arguments!=undefined&&arguments.length>0){this.resetFilter();this._filters=this._filters||[];var e={};e.args=[];e.effect=arguments[0];for(var t=1;t<arguments.length;t++){e.args.push(arguments[t])}this._filters[e.effect]=e;return this}else{return this._filters}};t.collides=function(e,t){var n=this,r=e;var i=n.x()<r.x()+r.width()&&n.x()+n.width()>r.x()&&n.y()<r.y()+r.height()&&n.y()+n.height()>r.y();if(i)t.call(this)};t.resetFilter=function(){this.filter_cache=null};t.drag=function(e){return this.on("drag",e)};t._cleartrace=function(){if(this._trace_canvas){this._trace_canvas.canvas.width=this._trace_canvas.canvas.width}};t._transform_reset=function(){this.transform.save();this.transform.setMatrix([1,0,0,1,0,0])};e.DisplayObject=DisplayObject})(window);(function(e){Loop=function(t,n){$$_canvas.bind("draw",t,n||e);EventTarget.call(this)};var t=Loop.prototype=new EventTarget;t.constructor=Loop;e.Loop=Loop})(window);(function(e){Transform=function(e){this.context=e;this.matrix=[1,0,0,1,0,0];this.stack=[]};var t=Transform.prototype;t.setContext=function(e){this.context=e};t.getMatrix=function(){return this.matrix};t.setMatrix=function(e){this.matrix=[e[0],e[1],e[2],e[3],e[4],e[5]];this.setTransform()};t.cloneMatrix=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]};t.save=function(){var e=this.cloneMatrix(this.getMatrix());this.stack.push(e);if(this.context)this.context.save()};t.restore=function(){if(this.stack.length>0){var e=this.stack.pop();this.setMatrix(e)}if(this.context)this.context.restore()};t.setTransform=function(){if(this.context){this.context.setTransform(this.matrix[0],this.matrix[1],this.matrix[2],this.matrix[3],this.matrix[4],this.matrix[5])}};t.translate=function(e,t){this.matrix[4]+=this.matrix[0]*e+this.matrix[2]*t;this.matrix[5]+=this.matrix[1]*e+this.matrix[3]*t;this.setTransform()};t.rotate=function(e){var t=Math.cos(e);var n=Math.sin(e);var r=this.matrix[0]*t+this.matrix[2]*n;var i=this.matrix[1]*t+this.matrix[3]*n;var s=this.matrix[0]*-n+this.matrix[2]*t;var o=this.matrix[1]*-n+this.matrix[3]*t;this.matrix[0]=r;this.matrix[1]=i;this.matrix[2]=s;this.matrix[3]=o;this.setTransform()};t.scale=function(e,t){this.matrix[0]*=e;this.matrix[1]*=e;this.matrix[2]*=t;this.matrix[3]*=t;this.setTransform()};t.rotateDegrees=function(e){var t=e*Math.PI/180;this.rotate(t)};t.rotateAbout=function(e,t,n){this.translate(t,n);this.rotate(e);this.translate(-t,-n);this.setTransform()};t.rotateDegreesAbout=function(e,t,n){this.translate(t,n);this.rotateDegrees(e);this.translate(-t,-n);this.setTransform()};t.identity=function(){this.matrix=[1,0,0,1,0,0];this.setTransform()};t.multiply=function(e){var t=this.matrix[0]*e.m[0]+this.matrix[2]*e.m[1];var n=this.matrix[1]*e.m[0]+this.matrix[3]*e.m[1];var r=this.matrix[0]*e.m[2]+this.matrix[2]*e.m[3];var i=this.matrix[1]*e.m[2]+this.matrix[3]*e.m[3];var s=this.matrix[0]*e.m[4]+this.matrix[2]*e.m[5]+this.matrix[4];var o=this.matrix[1]*e.m[4]+this.matrix[3]*e.m[5]+this.matrix[5];this.matrix[0]=t;this.matrix[1]=n;this.matrix[2]=r;this.matrix[3]=i;this.matrix[4]=s;this.matrix[5]=o;this.setTransform()};t.invert=function(){var e=1/(this.matrix[0]*this.matrix[3]-this.matrix[1]*this.matrix[2]);var t=this.matrix[3]*e;var n=-this.matrix[1]*e;var r=-this.matrix[2]*e;var i=this.matrix[0]*e;var s=e*(this.matrix[2]*this.matrix[5]-this.matrix[3]*this.matrix[4]);var o=e*(this.matrix[1]*this.matrix[4]-this.matrix[0]*this.matrix[5]);this.matrix[0]=t;this.matrix[1]=n;this.matrix[2]=r;this.matrix[3]=i;this.matrix[4]=s;this.matrix[5]=o;this.setTransform()};t.transformPoint=function(e,t){return{x:e*this.matrix[0]+t*this.matrix[2]+this.matrix[4],y:e*this.matrix[1]+t*this.matrix[3]+this.matrix[5]}};e.Transform=Transform})(window);(function(e){Events=function(t){e.$$_EVENTS_CHILDREN=e.$$_EVENTS_CHILDREN||[];e.$$_EVENTS_DRAG_CHILDREN=e.$$_EVENTS_DRAG_CHILDREN||[]};var t=Events.prototype;t.constructor=Events;t.on=function(e,t){$$_EVENTS_CHILDREN.push({object:this,event:e,callback:t});return this};e.Events=Events})(window);(function(e){Bitmap=function(e){EventTarget.call(this);this._context=e;this.extend(this,new Events);this.extend(this,new Animate);this.transform=new Transform(this._context);this._lastDrawState=""};var t=Bitmap.prototype=new DisplayObject;t.constructor=Bitmap;t.init=function(){this.x(0);this.y(0)};t.src=function(e){if(e){this._src=e;this._loadsrc(this._src);return this}else{return this._src}};t.draw=function(){var e,t=this.width()/this.orig_width,n=this.height()/this.orig_height;this._transform_reset();this.fire("beginDraw");if(this.trace()){e=this._handle_trace(t,n,this._src,"initial")}else{e=this._handle_basic(t,n)}e=this._handle_filters(e);this.transform.context.drawImage(e,0,0);this._lastDrawState=e;this.transform.restore();this.fire("finishDraw");return this};t.toDataURL=function(t){this._dataurl_canvas=this._dataurl_canvas||Util.createContext("dataurl_"+this.id());this._dataurl_transform=this._dataurl_transform||new Transform(this._dataurl_canvas.context);if(!t){this._dataurl_canvas.canvas.width=this.width();this._dataurl_canvas.canvas.height=this.height()}this._dataurl_transform.save();this._dataurl_transform.setMatrix([1,0,0,1,0,0]);this._dataurl_canvas.context.clearRect(0,0,this._dataurl_canvas.canvas.width,this._dataurl_canvas.canvas.height);this._dataurl_transform.translate(this.x(),this.y());var n=this.width()/this.orig_width,r=this.height()/this.orig_height,i=this._dataurl_transform.getMatrix();if(t!=null){this._dataurl_canvas.context.drawImage(e.$$_canvas.canvas(),0,0)}else{this._dataurl_transform.rotate(this.rotate());this._dataurl_transform.scale(this.width()/this.orig_width*this.scale(),this.height()/this.orig_height*this.scale());this._dataurl_transform.context.globalAlpha=this.alpha();this._applyShadow(this._dataurl_transform.context);this._dataurl_canvas.context.drawImage(this._lastDrawState,0,0)}return this._dataurl_canvas.canvas.toDataURL()};t.mouseDraw=function(){this._mouse_canvas=this._mouse_canvas||Util.createContext("mouse_"+this.id());this._mouse_transform=this._mouse_transform||new Transform(this._mouse_canvas.context);this._mouse_transform.save();this._mouse_transform.setMatrix([1,0,0,1,0,0]);this._mouse_canvas.context.clearRect(0,0,this._mouse_canvas.canvas.width,this._mouse_canvas.canvas.height);this._mouse_transform.translate(this.x(),this.y());var e=this.width()/this.orig_width,t=this.height()/this.orig_height,n=this._mouse_transform.getMatrix();this._mouse_transform.rotate(this.rotate());this._mouse_transform.scale(this.width()/this.orig_width*this.scale(),this.height()/this.orig_height*this.scale());this._mouse_transform.context.globalAlpha=this.alpha();this._applyShadow(this._mouse_transform.context);this._mouse_canvas.context.drawImage(this._src,0,0);return this._mouse_canvas.context};t.trace=function(e){if(e===false)this._cleartrace();if(e!=null){this._trace=e;return this}else{return this._trace||false}};t._loadsrc=function(e){(function(e,t){var n=new Image;n.src=t;n.onload=function(){e.orig_width=n.width;e.orig_height=n.height;e.width(e.width()||n.width);e.height(e.height()||n.height);e._src=n;e.bind("draw",e.draw,e);e.ready(true);e.draw();e.fire("loaded")}})(this,e)};t._handle_filters=function(e){var t;if(this.filter()&&!this.filter_cache){if(this._filter_canvas)Util.removeElement(this._filter_canvas.canvas.id);this._filter_canvas=this._filter_canvas||Util.createContext("filter_"+this.id());this._filter_canvas.canvas.width=this.orig_width;this._filter_canvas.canvas.height=this.orig_height;if(this.trace()){this._filter_canvas.context.drawImage(e,-this.x(),-this.y())}else{this._filter_canvas.context.drawImage(e,0,0)}for(var n in this.filter()){t=Filter.get(this._filter_canvas,this.filter()[n],this);this.filter_cache=t}}else if(this.filter_cache){t=this.filter_cache}else{t=e}if(this.trace()&&this.filter()){t=this._handle_trace(1,1,t,"filter")}return t};t._handle_trace=function(e,t,n,r){var i=this["trace_"+this.id()+"_"+r]||Util.createContext("trace_"+this.id()+"_"+r);this["trace_"+this.id()+"_"+r]=i;var s=this["trace_transfrom_"+this.id()+"_"+r]||new Transform(i.context);this["trace_transfrom_"+this.id()+"_"+r]=s;s.save();s.setMatrix([1,0,0,1,0,0]);s.translate(this.x(),this.y());s.rotate(this.rotate());s.scale(e*this.scale(),t*this.scale());s.context.globalAlpha=this.alpha();this._applyStroke(i.context,{x:0,y:0,w:this.orig_width,h:this.orig_height});this._applyShadow(s.context);i.context.drawImage(n,0,0);return i.canvas};t._handle_basic=function(e,t){this.transform.context.globalAlpha=this.alpha();this._applyStroke(this.transform.context,{x:this.x(),y:this.y(),w:this.width(),h:this.height()});this.transform.translate(this.x(),this.y());this.transform.rotate(this.rotate());this.transform.scale(e*this.scale(),t*this.scale());this._applyShadow(this.transform.context);return this._src};t.name="Bitmap Instance";e.Bitmap=Bitmap})(window);(function(e){Path=function(e){EventTarget.call(this);this._paths=this._paths||[];this._context=e;this.transform=new Transform(this._context)};var t=Path.prototype=new EventTarget;t.constructor=Path;t.init=function(){this.bind("draw",this.draw,this)};t.width=function(e){if(e){this._width=e;return this}else{return this._width}};t.color=function(e){if(e!=null){this._color=e;return this}else{return this._color||"#000"}};t.beginPath=function(e,t){this._p_startX=e;this._p_startY=t;return this};t.style=function(e){if(e.width)this.width(e.width);if(e.color)this.color(e.color);return this};t.to=function(e,t){this._paths.push({x:e,y:t});return this};t.end=function(e){if(e!=null){this._end=e;return this}else{return this._end||false}};t.draw=function(e){this.transform.save();this.transform.setMatrix([1,0,0,1,0,0]);this.transform.context.beginPath();this.transform.context.moveTo(this._p_startX,this._p_startY);for(var t=0;t<this._paths.length;t++){if(this._paths[t]!=null)this.transform.context.lineTo(this._paths[t].x,this._paths[t].y)}this.transform.context.strokeStyle=this.color()||"#000";this.transform.context.lineWidth=this.width()||1;this.transform.context.globalAlpha=this.alpha();this._applyShadow(this.transform.context);if(this.end())this.transform.context.closePath();this.transform.context.stroke();this.transform.restore();return this};t.name="Path Instance";e.Path=Path})(window);(function(e){Sprite=function(e){EventTarget.call(this);this._context=e;this.extend(this,new Events);this.extend(this,new Animate);this.transform=new Transform(this._context);this.iterate=0;this._sequences={};this._curSequence=null;this._stopindex=null;this._lastDrawState=""};var t=Sprite.prototype=new Bitmap;t.constructor=Sprite;t.src=function(e,t){if(e&&t){Util.getJSON(t,function(t){this._src=e;this.frames=t.frames;this._curSequence={start:0,end:this.frames.length};this._loadsrc(this._src)},this);return this}else{return this._src}};t.draw=function(e){if(!this.ready())return;var t,n=this.width()/this.orig_width,r=this.height()/this.orig_height;this._transform_reset();this.fire("beginDraw");t=this._handle_sprite(this._src);if(this.trace()){t=this._handle_trace(n,r,t,"initial")}else{this._handle_basic(n,r)}this.resetFilter();t=this._handle_filters(t);this.transform.context.drawImage(t,0,0);this._lastDrawState=t;this.transform.restore();this.fire("finishDraw");return this};t._handle_sprite=function(e){var t,n,r,i,s,o,u;this._sprite_canvas=this._sprite_canvas||Util.createContext("sprite_"+this.id());if(this.iterate<this._curSequence.end-1){if(this.gotoAndStop()!==null){this.iterate=this.gotoAndStop()}else{this.iterate++}}n=this.frames[this.iterate].frame.w+this.padding();r=this.frames[this.iterate].frame.h+this.padding();i=this.frames[this.iterate].frame.x;s=this.frames[this.iterate].frame.y;o=this._sprite_canvas.context;u=this._sprite_canvas.canvas;u.width=n;u.height=r;if(!this._src_sprite){this._src_sprite=this._src;this._src=u}o.clearRect(0,0,u.width,u.height);t=o.drawImage(this._src_sprite,-i,-s);if(this.iterate===this._curSequence.end-1&&this.loop()){this.iterate=this._curSequence.start}return u};t.loop=function(e){if(e!=null){this._loop=e;return this}else{return this._loop||false}};t.padding=function(e){if(e!=null){this._padding=e;return this}else{return this._padding||0}};t.gotoAndStop=function(e){if(e!=null){if(typeof e==="string"){this._stopindex=this._sequences[e].end}else{this._curSequenceName="";this._stopindex=e}this.draw();return this}else{return this._stopindex}};t.gotoAndPlay=function(e){if(e!=null){if(typeof e==="string"){this.run(e)}else{this.iterate=e}this._stopindex=null;this.draw();return this}else{return this._stopindex}return this};t.sequence=function(e,t,n){this._sequences[e]={start:t,end:n};return this};t.run=function(e,t){if(this._curSequenceName!=e){var n=this._sequences[e];n.start=parseFloat(n.start);n.end=parseFloat(n.end);this._curSequence=n;this._stopindex=null;if(this._curSequence.start!=this._sequences[e].start||this._curSequence.start===0){this.iterate=n.start;this._curSequenceName=e}if(t===true)this.loop(true)}this.draw();return this};t.name="Sprite Instance";e.Sprite=Sprite})(window);(function(e){Rectangle=function(e){EventTarget.call(this);this._context=e;this.extend(this,new Events);this.extend(this,new Animate);this.transform=new Transform(this._context);this.ctx=this.transform.context};var t=Rectangle.prototype=new DisplayObject;t.constructor=Rectangle;t.init=function(){this.x(0);this.y(0);this.ready(true);this.bind("draw",this.draw,this)};t.draw=function(e){this._transform_reset();this.fire("beginDraw");this.transform.translate(this.x(),this.y());this.transform.rotate(this.rotate());this.transform.scale(1*this.scale(),1*this.scale());this._applyShadow(this.ctx);this.ctx.fillStyle=this.color();this.ctx.globalAlpha=this.alpha();this.ctx.beginPath();this.ctx.moveTo(this.x()+this.radius(),this.y());this.ctx.lineTo(this.x()+this.width()-this.radius(),this.y());this.ctx.quadraticCurveTo(this.x()+this.width(),this.y(),this.x()+this.width(),this.y()+this.radius());this.ctx.lineTo(this.x()+this.width(),this.y()+this.height()-this.radius());this.ctx.quadraticCurveTo(this.x()+this.width(),this.y()+this.height(),this.x()+this.width()-this.radius(),this.y()+this.height());this.ctx.lineTo(this.x()+this.radius(),this.y()+this.height());this.ctx.quadraticCurveTo(this.x(),this.y()+this.height(),this.x(),this.y()+this.height()-this.radius());this.ctx.lineTo(this.x(),this.y()+this.radius());this.ctx.quadraticCurveTo(this.x(),this.y(),this.x()+this.radius(),this.y());this.ctx.closePath();this.ctx.fill();this.transform.restore();this.fire("finishDraw");return this};t.mouseDraw=function(){this._mouse_canvas=this._mouse_canvas||Util.createContext("mouse_"+this.id());this._mouse_transform=this._mouse_transform||new Transform(this._mouse_canvas.context);this._mouse_transform.save();this._mouse_transform.setMatrix([1,0,0,1,0,0]);this._mouse_canvas.context.clearRect(0,0,this._mouse_canvas.canvas.width,this._mouse_canvas.canvas.height);this._mouse_transform.translate(this.x(),this.y());var e=this.width()/this.orig_width,t=this.height()/this.orig_height,n=this._mouse_transform.getMatrix();this._mouse_transform.rotate(this.rotate());this._mouse_transform.scale(this.width()/this.orig_width*this.scale(),this.height()/this.orig_height*this.scale());this._mouse_transform.context.globalAlpha=this.alpha();this._applyShadow(this._mouse_transform.context);this._mouse_canvas.context.fillStyle=this.color();this._mouse_canvas.context.globalAlpha=this.alpha();this._mouse_canvas.context.fillRect(0,0,this.width(),this.height());return this._mouse_canvas.context};t.color=function(e){if(e!=null){this._color=e;return this}else{return this._color}};t.radius=function(e){if(e!=null){this._radius=e;return this}else{return this._radius||0}};t.name="Rectangle Instance";e.Rectangle=Rectangle})(window);(function(e){FrameTicker=function(){this.init();this.timerID=0;this.timers=[];this.on=true;EventTarget.call(this)};var t=FrameTicker.prototype=new EventTarget;t.constructor=FrameTicker;t.init=function(){e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,n){e.setTimeout(t,1e3/60)}}()};t.start=function(t){if(this.timerID)return;var n=this;(function(){var r=arguments.callee;if(n.on){n._requestTimeout(function(){n.fire("tick");n.timerID=e.requestAnimFrame(r)},t)}})();return n};t.stop=function(){this.on=false};t._requestTimeout=function(t,n){function s(){var e=(new Date).getTime(),o=e-r;o>=n?t.call():i.value=requestAnimFrame(s)}if(!e.requestAnimationFrame&&!e.webkitRequestAnimationFrame&&!(e.mozRequestAnimationFrame&&e.mozCancelRequestAnimationFrame)&&!e.oRequestAnimationFrame&&!e.msRequestAnimationFrame)return e.setTimeout(t,n);var r=(new Date).getTime(),i=new Object;i.value=requestAnimFrame(s);return i};e.FrameTicker=FrameTicker})(window);(function(window){function Tweenie(){var e=this}function Tween_runner(p_tween,p_home){EventTarget.call(this);this.on=true;this.tween=p_tween;this.id=p_tween.what.id;this._home=p_home;var _this=this;(function(){var obj,elapsed,ease_val,c_time,calculation,obj_delta;c_time=Date.now();obj=p_tween;obj.what._animating=true;for(var property in obj.props){elapsed=(c_time-obj.start_time)/obj.duration;elapsed=elapsed>1?1:elapsed;ease_val=eval("Easing."+obj.easing+"("+elapsed+")");calculation=obj.distance["start_"+property]+obj.distance["delta_"+property]*ease_val;if(elapsed!=1)obj.what[property](calculation);if(obj.callback&&elapsed===1){if(_this.on==true){obj.callback.call(obj.what);_this.fire("finished")}obj.what._animating=false;_this.on=false}else if(obj.update){var o={};for(var p in obj.props){o[p]=obj.what[p]}obj.update.call(obj.what,o)}else if(elapsed===1){_this.fire("finished");_this.on=false;obj.what._animating=false}}if(_this.on){_this.timerID=setTimeout(arguments.callee,$$_canvas.framerate())}else{_this.fire("finished");obj.what._animating=false}})()}var _pt=Tween_runner.prototype=new EventTarget;var _pt=Tweenie.prototype;_pt._tweens=[];_pt.to=function(e,t,n,r,i,s,o){var u="id_"+e.id();if(this._tweens.hasOwnProperty("id_"+e.id())){this._tweens[u].on=false}var a={};for(var f in t){a["start_"+f]=e[f]();a["delta_"+f]=t[f]-e[f]()}var l=Date.now()+(o?o:0);var c=new Tween_runner({what:e,start_time:l,duration:n,easing:r,props:t,distance:a,update:i,callback:s},this);this._tweens[u]=c;c.bind("finished",this._cleanup,c)};_pt.stop=function(e){if(e.id>=0){for(var t=0;t<this._tweens.length;t++){if(this._tweens[t].id==e.id){this._tweens[t].on=false}}}};_pt._cleanup=function(e){var t=this._home._tweens;for(key in t){if(t.hasOwnProperty(key)){if(t[key].id==this.id){delete t[key]}}}};Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};Easing.Linear.EaseNone=function(e){return e};Easing.none=function(e){return e};Easing.Quadratic.EaseIn=function(e){return e*e};Easing.Quadratic.EaseOut=function(e){return-e*(e-2)};Easing.Quadratic.EaseInOut=function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)};Easing.Cubic.EaseIn=function(e){return e*e*e};Easing.Cubic.EaseOut=function(e){return--e*e*e+1};Easing.Cubic.EaseInOut=function(e){if((e*=2)<1)return.5*e*e*e;return.5*((e-=2)*e*e+2)};Easing.Quartic.EaseIn=function(e){return e*e*e*e};Easing.Quartic.EaseOut=function(e){return-(--e*e*e*e-1)};Easing.Quartic.EaseInOut=function(e){if((e*=2)<1)return.5*e*e*e*e;return-.5*((e-=2)*e*e*e-2)};Easing.Quintic.EaseIn=function(e){return e*e*e*e*e};Easing.Quintic.EaseOut=function(e){return(e=e-1)*e*e*e*e+1};Easing.Quintic.EaseInOut=function(e){if((e*=2)<1)return.5*e*e*e*e*e;return.5*((e-=2)*e*e*e*e+2)};Easing.Sinusoidal.EaseIn=function(e){return-Math.cos(e*Math.PI/2)+1};Easing.Sinusoidal.EaseOut=function(e){return Math.sin(e*Math.PI/2)};Easing.Sinusoidal.EaseInOut=function(e){return-.5*(Math.cos(Math.PI*e)-1)};Easing.Exponential.EaseIn=function(e){return e==0?0:Math.pow(2,10*(e-1))};Easing.Exponential.EaseOut=function(e){return e==1?1:-Math.pow(2,-10*e)+1};Easing.Exponential.EaseInOut=function(e){if(e==0)return 0;if(e==1)return 1;if((e*=2)<1)return.5*Math.pow(2,10*(e-1));return.5*(-Math.pow(2,-10*(e-1))+2)};Easing.Circular.EaseIn=function(e){return-(Math.sqrt(1-e*e)-1)};Easing.Circular.EaseOut=function(e){return Math.sqrt(1- --e*e)};Easing.Circular.EaseInOut=function(e){if((e/=.5)<1)return-.5*(Math.sqrt(1-e*e)-1);return.5*(Math.sqrt(1-(e-=2)*e)+1)};Easing.Elastic.EaseIn=function(e){var t,n=.1,r=.4;if(e==0)return 0;if(e==1)return 1;if(!r)r=.3;if(!n||n<1){n=1;t=r/4}else t=r/(2*Math.PI)*Math.asin(1/n);return-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r))};Easing.Elastic.EaseOut=function(e){var t,n=.1,r=.4;if(e==0)return 0;if(e==1)return 1;if(!r)r=.3;if(!n||n<1){n=1;t=r/4}else t=r/(2*Math.PI)*Math.asin(1/n);return n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/r)+1};Easing.Elastic.EaseInOut=function(e){var t,n=.1,r=.4;if(e==0)return 0;if(e==1)return 1;if(!r)r=.3;if(!n||n<1){n=1;t=r/4}else t=r/(2*Math.PI)*Math.asin(1/n);if((e*=2)<1)return-.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r);return n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)*.5+1};Easing.Back.EaseIn=function(e){var t=1.70158;return e*e*((t+1)*e-t)};Easing.Back.EaseOut=function(e){var t=1.70158;return(e=e-1)*e*((t+1)*e+t)+1};Easing.Back.EaseInOut=function(e){var t=1.70158*1.525;if((e*=2)<1)return.5*e*e*((t+1)*e-t);return.5*((e-=2)*e*((t+1)*e+t)+2)};Easing.Bounce.EaseIn=function(e){return 1-Easing.Bounce.EaseOut(1-e)};Easing.Bounce.EaseOut=function(e){if((e/=1)<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}};Easing.Bounce.EaseInOut=function(e){if(e<.5)return Easing.Bounce.EaseIn(e*2)*.5;return Easing.Bounce.EaseOut(e*2-1)*.5+.5};window.Easing=Easing;window.Tweenie=Tweenie})(window);(function(e){Canvas=function(t){EventTarget.call(this);this._canvas=document.getElementById(t);this._canvas.width=this.canvas().getAttribute("width")||e.innerWidth;this._canvas.height=this.canvas().getAttribute("height")||e.innerHeight;if(!this._canvas||!this._canvas.getContext)throw"No Canvas Support.";this.context(this._canvas.getContext("2d"));this.context().translate(0,0);this.framerate(this.canvas().getAttribute("framerate")||0);this._engine=new FrameTicker;this._engine.start(this.framerate()).bind("tick",this._childrenDraw,this);this.init()};var t=Canvas.prototype=new EventTarget;t.constructor=Canvas;t.init=function(){HTMLCanvasElement.prototype.relMouseCoords=function(e){var t=0;totalOffsetY=0;canvasX=0;canvasY=0;currentElement=this;do{t+=currentElement.offsetLeft;totalOffsetY+=currentElement.offsetTop}while(currentElement=currentElement.offsetParent);canvasX=e.pageX-t;canvasY=e.pageY-totalOffsetY;canvasX=Math.round(canvasX*(this.width/this.offsetWidth));canvasY=Math.round(canvasY*(this.height/this.offsetHeight));return{x:canvasX,y:canvasY}};var t=this;if(document.addEventListener){document.addEventListener("mouseup",function(e){t._MouseUpHandler(e)},false);document.addEventListener("mousemove",function(e){t._MouseMoveHandler(e)},false);document.addEventListener("onkeydown",function(e){t._keyDownHandler(e)},false);document.onkeydown=t._keyDownHandler;document.onkeypress=t._keyDownHandler;document.onkeyup=t._keyDownHandler}else if(e.addEventListener){e.addEventListener("mouseup",function(e){t._MouseUpHandler(e)},false);e.addEventListener("mousemove",function(e){t._MouseMoveHandler(e)},false);e.addEventListener("onkeydown",function(e){t._keyDownHandler(e)},false);e.onkeydown=t._keyDownHandler;e.onkeypress=t._keyDownHandler;e.onkeyup=t._keyDownHandler}this._canvas.addEventListener("mousedown",function(e){t._MouseDownHandler(e)},false)};t.width=function(e){if(e){this._width=e;return this}else{return this._width}};t.height=function(e){if(e){this._height=e;return this}else{return this._height}};t.framerate=function(e){if(e){this._framerate=e;return this}else{return this._framerate||6}};t.context=function(e){if(e){this._context=e;return this}else{return this._context||""}};t.canvas=function(e){if(e){this._canvas=e;return this}else{return this._canvas}};t._childrenDraw=function(){this.fire("draw");this.context().clearRect(0,0,this._canvas.width,this._canvas.height);for(var e=0;e<$$_CHILDREN.length;e++){if($$_CHILDREN[e].visible())$$_CHILDREN[e].fire("draw")}};t._keyDownHandler=function(e){for(var t=$$_EVENTS_CHILDREN.length-1;t>=0;t--){if($$_EVENTS_CHILDREN[t].event===e.type){$$_EVENTS_CHILDREN[t].callback.call($$_EVENTS_CHILDREN[t].object,e)}}};t._MouseDownHandler=function(e,t){var n=this.canvas().relMouseCoords(e),r=n.x,i=n.y,s=this;for(var o=$$_EVENTS_CHILDREN.length-1;o>=0;o--){if($$_EVENTS_CHILDREN[o].event==="click"){if(Util.checkPIXEL($$_EVENTS_CHILDREN[o].object,r,i)){$$_EVENTS_CHILDREN[o].callback.call($$_EVENTS_CHILDREN[o].object)}}if($$_EVENTS_CHILDREN[o].event==="drag"&&!$$_EVENTS_DRAG_CHILDREN[$$_EVENTS_CHILDREN[o].object.id()+"_obj"]){if(Util.checkPIXEL($$_EVENTS_CHILDREN[o].object,r,i)){var u=$$_EVENTS_DRAG_CHILDREN[$$_EVENTS_CHILDREN[o].object.id()+"_obj"]=$$_EVENTS_CHILDREN[o];u.clickX=r;u.clickY=i;u.pastX=u.object.x();u.pastY=u.object.y();$$_EVENTS_CHILDREN[o].callback.call($$_EVENTS_CHILDREN[o].object,{eventType:"onStart"});return}}}};t._MouseUpHandler=function(e){for(obj in $$_EVENTS_DRAG_CHILDREN){if($$_EVENTS_DRAG_CHILDREN[obj].event==="drag"){$$_EVENTS_DRAG_CHILDREN[obj].callback.call($$_EVENTS_DRAG_CHILDREN[obj].object,{eventType:"onFinished"});delete $$_EVENTS_DRAG_CHILDREN[obj]}}};t._MouseMoveHandler=function(e){var t=this.canvas().relMouseCoords(e),n=t.x,r=t.y,i=this,s,o;for(var u=$$_EVENTS_CHILDREN.length-1;u>=0;u--){if($$_EVENTS_CHILDREN[u].event==="hover"){if(Util.checkPIXEL($$_EVENTS_CHILDREN[u].object,n,r)){$$_EVENTS_CHILDREN[u].callback.call($$_EVENTS_CHILDREN[u].object)}}}for(obj in $$_EVENTS_DRAG_CHILDREN){if($$_EVENTS_DRAG_CHILDREN[obj].event==="drag"){var a=$$_EVENTS_DRAG_CHILDREN[obj];s=n-Math.abs(a.pastX-a.clickX);o=r-Math.abs(a.pastY-a.clickY);a.object.x(s);a.object.y(o);$$_EVENTS_DRAG_CHILDREN[obj].callback.call(a.object,{eventType:"onUpdate"});a.clickX=n;a.clickY=r;a.pastX=a.object.x();a.pastY=a.object.y()}}};e.Canvas=Canvas})(window);(function(window){Element=function(p_class,p_def){if(p_class){window.$$_CHILDREN=window.$$_CHILDREN||[];window.$$_TWEENS=window.$$_TWEENS||{};window.$$_canvas=window.$$_canvas||new Canvas(this.canvas_id()||"element-root");var _temp=eval("new "+p_class+"(window.$$_canvas.context())");_temp=this.extend(_temp,new Element);_temp.id(window.$$_CHILDREN.length+"_id");_temp.index(window.$$_CHILDREN.length);_temp.visible(true);_temp.alpha(1);_temp._tweenie=new Tweenie;if(typeof _temp.init==="function")_temp.init();window.$$_CHILDREN.push(_temp);_temp._handelDefinition(p_def,_temp);return _temp}};var _pt=Element.prototype=new Basic;_pt.alpha=function(e){if(e!=null){this._alpha=e;return this}else{return this._alpha}};_pt.visible=function(e){if(e!=null){this._visible=e;return this}else{return this._visible}};_pt.mask=function(e){if(e){this._mask=e;return this}else{return this._mask}};_pt.id=function(e){if(e){this._id=e;return this}else{return this._id}};_pt.canvas_id=function(e){if(e){this._id=e;return this}else{return this._id}};_pt.index=function(e){if(e!=null){this._index=e;return this}else{return this._index}};_pt.ready=function(e){if(e){this._ready=e;return this}else{return this._ready||false}};_pt.shadow=function(e){if(e){this._shadow=e;return this}else{return this._shadow||{}}};_pt.border=function(e){if(e){this._border=e;return this}else{return this._border||{width:0,color:null}}};_pt.top=function(){var e=Util.getIndex(this);var t=$$_CHILDREN.splice(e,1);$$_CHILDREN.push(t[0]);return this};_pt.bottom=function(){var e=Util.getIndex(this);var t=$$_CHILDREN.splice(e,1);$$_CHILDREN.unshift(t[0]);return this};_pt.toString=function(){return"["+this.name+" Instance]"};_pt._applyStroke=function(e,t){if(this.border().color!=null){var n=e,r=this.border(),i=t;n.beginPath();n.rect(i.x,i.y,i.w,i.h);n.strokeStyle=r.color;n.lineWidth=r.width;n.closePath();n.stroke()}};_pt._applyShadow=function(e){if(this.shadow().color!=null){var t=e,n=this.shadow(),r=Util.hexToRGB(n.color);t.shadowColor="rgba("+r.r+", "+r.b+", "+r.g+", "+(n.alpha||1)+")";t.shadowBlur=n.blur;t.shadowOffsetX=n.x;t.shadowOffsetY=n.y}};_pt._handelDefinition=function(e,t){if(e!=null){var n,r=[],i;for(var s in e){if(s==="filter"||s==="sequence"){n=e[s].split(",");for(var o=0;o<n.length;o++){r=n[o].split(":");if(r.length>1){t[s].apply(t,r)}else{t[s](n[o])}}}else{r=typeof e[s]=="string"?e[s].split(","):e[s];if(r.length>1){t[s].apply(t,r)}else{t[s](e[s])}}}}};window.Element=Element})(window)